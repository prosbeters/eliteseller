<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProSbe | Asisten Bisnis Paling Pengertian</title>
    
    <!-- Library Eksternal -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            --luxury-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.08);
        }

        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #f8fafc;
            color: #0f172a;
            scroll-behavior: smooth;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .animate-in { animation: fade-in-up 0.8s cubic-bezier(0.19, 1, 0.22, 1) forwards; }
        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .glass-header {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(226, 232, 240, 0.8);
        }

        .luxury-card {
            background: white;
            border-radius: 2.5rem;
            border: 1px solid rgba(241, 245, 249, 1);
            box-shadow: var(--luxury-shadow);
            transition: all 0.4s ease;
        }

        .luxury-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 40px 80px -15px rgba(0, 0, 0, 0.12);
        }

        /* Styling Output AI - Rapi & Justify */
        .prose h2 { font-weight: 800; color: #1e40af; margin-top: 3rem; margin-bottom: 1.5rem; font-size: 2.2rem; border-left: 8px solid #1e40af; padding-left: 1.5rem; text-align: left; }
        .prose h3 { font-weight: 700; color: #1e293b; margin-top: 2rem; margin-bottom: 1rem; font-size: 1.6rem; text-align: left; }
        .prose p { margin-bottom: 1.5rem; line-height: 1.9; color: #475569; font-size: 1.15rem; text-align: justify; }
        .prose strong { color: #2563eb; font-weight: 700; }
        .prose ol { padding-left: 1.5rem; margin-bottom: 2rem; list-style-type: decimal; }
        .prose li { margin-bottom: 0.8rem; line-height: 1.8; color: #334155; text-align: justify; }

        .elite-input {
            border: 2px solid transparent;
            background: #f1f5f9;
            border-radius: 1.5rem;
            padding: 1.5rem 2rem;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        .elite-input:focus {
            outline: none;
            border-color: #3b82f6;
            background: white;
            box-shadow: 0 0 0 5px rgba(59, 130, 246, 0.1);
        }
        
        .elite-input::placeholder {
            color: #94a3b8;
            font-weight: 400;
            font-style: italic;
            opacity: 0.6;
        }

        .tab-btn {
            position: relative;
            transition: all 0.4s ease;
        }
        .tab-btn.active::after {
            content: ''; position: absolute; bottom: -5px; left: 50%; transform: translateX(-50%); width: 25px; height: 5px; background: #3b82f6; border-radius: 10px;
        }

        .btn-premium {
            background: #0f172a;
            color: white;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }
        .btn-premium:hover {
            background: #1e40af; transform: scale(1.02); box-shadow: 0 20px 40px -10px rgba(30, 64, 175, 0.4);
        }
    </style>
</head>
<body class="selection:bg-blue-600 selection:text-white overflow-x-hidden">

    <!-- OFFLINE NOTIFICATION -->
    <div id="offline-alert" class="hidden fixed top-0 left-0 right-0 z-[200] bg-rose-600 text-white py-2 px-8 text-center text-xs font-black uppercase tracking-widest animate-pulse">
        Koneksi Terputus! Cek internet kamu Boss.
    </div>

    <!-- LOGIN SCREEN -->
    <div id="login-screen" class="min-h-screen flex items-center justify-center p-8 bg-slate-950 relative overflow-hidden text-center">
        <div class="absolute top-[-20rem] left-[-10rem] w-[60rem] h-[60rem] bg-blue-600/20 rounded-full blur-[180px]"></div>
        <div class="w-full max-w-md relative z-10 animate-in">
            <div class="mb-16">
                <div class="inline-block p-6 bg-white/5 border border-white/10 rounded-[3rem] mb-8 backdrop-blur-md">
                    <i data-lucide="shield-check" class="w-16 h-16 text-blue-500"></i>
                </div>
                <h2 class="text-6xl font-extrabold text-white tracking-tighter mb-4 text-center">Pro<span class="text-blue-500 font-light italic">Sbe</span></h2>
                <p class="text-slate-400 text-sm font-bold uppercase tracking-[0.3em] opacity-80 text-center">Elite Strategic Intelligence System</p>
                <!-- ADDED TRIAL APP TEXT -->
                <p class="text-blue-500 text-xs font-black uppercase tracking-[0.4em] mt-2 text-center">Trial App</p>
            </div>
            <div class="space-y-6 text-left">
                <input type="email" id="login-email" placeholder="Email Terdaftar" class="w-full px-8 py-6 bg-white/5 border border-white/10 rounded-[2rem] text-white focus:outline-none" />
                <input type="password" id="login-password" placeholder="Password" class="w-full px-8 py-6 bg-white/5 border border-white/10 rounded-[2rem] text-white focus:outline-none" />
                <button onclick="handleLogin()" id="btn-login-action" class="w-full bg-blue-600 hover:bg-blue-400 text-white font-extrabold py-7 rounded-[2rem] flex items-center justify-center gap-4 group mt-8">
                    <span id="btn-login-text" class="uppercase tracking-widest text-xs">Masuk Sistem</span>
                    <i data-lucide="arrow-right" class="w-5 h-5"></i>
                </button>
                <div id="login-error" class="hidden mt-6 p-6 bg-rose-500/10 border border-rose-500/20 rounded-[2rem] text-rose-400 text-center">
                    <p id="error-message-text" class="text-xs font-bold uppercase text-center"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- MAIN APP CONTENT -->
    <div id="app-content" class="hidden">
        <header class="sticky top-0 z-50 glass-header">
            <div class="max-w-7xl mx-auto px-8">
                <div class="flex items-center justify-between h-28">
                    <div class="flex items-center gap-4 cursor-pointer" onclick="window.location.reload()">
                        <div class="w-12 h-12 bg-slate-900 rounded-2xl flex items-center justify-center text-white shadow-xl"><i data-lucide="shield-check" class="w-7 h-7"></i></div>
                        <h1 class="text-3xl font-black tracking-tighter uppercase leading-none">Pro<span class="text-blue-600 font-light italic">Sbe</span></h1>
                    </div>
                    <div class="flex items-center gap-6">
                        <div id="api-badge" class="hidden md:flex items-center gap-3 px-6 py-3 bg-emerald-50 text-emerald-600 rounded-full border border-emerald-100 text-[10px] font-black uppercase tracking-widest">
                            <div id="status-dot" class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></div>
                            <span id="status-text">Siap Bantu Boss!</span>
                        </div>
                        <div class="flex items-center bg-slate-100 rounded-2xl p-1">
                            <button onclick="toggleHelp()" class="p-4 text-slate-500 hover:text-blue-600 transition-all"><i data-lucide="help-circle" class="w-5 h-5"></i></button>
                            <button onclick="toggleApiSettings()" class="p-4 text-slate-500 hover:text-blue-600 transition-all"><i data-lucide="settings" class="w-5 h-5"></i></button>
                            <button onclick="handleLogout()" class="p-4 text-rose-500 hover:bg-white rounded-xl transition-all"><i data-lucide="log-out" class="w-5 h-5"></i></button>
                        </div>
                    </div>
                </div>
                <nav id="feature-nav" class="flex items-center gap-4 overflow-x-auto no-scrollbar pb-6 -mx-2 flex-nowrap"></nav>
            </div>
        </header>

        <main class="max-w-5xl mx-auto px-8 py-24 text-center md:text-left">
            <div id="api-warning" class="hidden mb-16 animate-in">
                <div class="bg-blue-600 rounded-[3rem] p-12 text-center text-white shadow-2xl relative overflow-hidden border-4 border-blue-400">
                    <h4 class="text-2xl font-extrabold mb-4 uppercase text-center">Aktivasi Otak AI Boss!</h4>
                    <p class="text-blue-100 mb-8 text-sm italic text-center">"Boss, masukin API Key dulu biar aku bisa mikir keras buat jualan kamu."</p>
                    
                    <div class="max-w-md mx-auto mb-10 bg-blue-700/40 rounded-[2rem] p-8 text-left border border-blue-300/20 backdrop-blur-sm">
                        <p class="text-[10px] font-black uppercase tracking-[0.2em] mb-4 text-blue-200">Cara Mendapatkan API Key (Gratis):</p>
                        <ol class="text-xs space-y-3 font-medium">
                            <li class="flex gap-3">
                                <span class="bg-white/20 w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0 text-[10px]">1</span>
                                <span>Buka <a href="https://aistudio.google.com/" target="_blank" class="underline font-bold text-white">Google AI Studio</a> & Login pakai Gmail.</span>
                            </li>
                            <li class="flex gap-3">
                                <span class="bg-white/20 w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0 text-[10px]">2</span>
                                <span>Klik tombol <b>"Get API key"</b> di menu sebelah kiri layar.</span>
                            </li>
                            <li class="flex gap-3">
                                <span class="bg-white/20 w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0 text-[10px]">3</span>
                                <span>Klik <b>"Create API key in new project"</b>, lalu SALIN kodenya.</span>
                            </li>
                        </ol>
                    </div>

                    <button onclick="toggleApiSettings()" class="bg-white text-blue-600 font-black px-10 py-5 rounded-2xl text-[11px] uppercase shadow-2xl hover:scale-105 transition-all">Input Kode Sekarang</button>
                </div>
            </div>

            <div class="mb-32 animate-in">
                <div class="inline-flex items-center gap-3 px-6 py-2.5 bg-blue-50 text-blue-700 rounded-full text-[10px] font-black uppercase tracking-[0.4em] mb-10 border border-blue-100">
                    <i data-lucide="sparkles" class="w-4 h-4"></i> High-End Strategic Intelligence
                </div>
                <h2 id="feature-title" class="text-6xl md:text-8xl font-black tracking-tighter leading-none uppercase mb-6 text-slate-900 text-center md:text-left">Halo Boss!</h2>
                <p id="feature-value-info" class="text-blue-600 font-extrabold text-2xl md:text-3xl uppercase tracking-tight mb-8 text-center md:text-left"></p>
                <p id="feature-role-desc" class="text-slate-500 text-xl md:text-2xl font-medium leading-relaxed max-w-3xl text-center md:text-left"></p>
            </div>

            <section id="form-area" class="mb-48 animate-in">
                <div id="dynamic-fields" class="grid grid-cols-1 md:grid-cols-2 gap-10 text-left"></div>
                <div id="generate-button-container" class="mt-20 hidden">
                    <button id="btn-generate" onclick="handleGenerate()" class="btn-premium py-10 px-20 rounded-[3rem] w-full text-center shadow-2xl">
                        <span class="tracking-[0.5em] uppercase text-sm font-black">Eksekusi Strategi Premium!</span>
                        <i data-lucide="zap" class="w-7 h-7"></i>
                    </button>
                </div>
            </section>

            <div id="result-container" class="hidden animate-in scroll-mt-24 pb-40">
                <div id="loading-state" class="hidden text-center py-20">
                    <div class="inline-block animate-spin mb-10 text-blue-600"><i data-lucide="loader-2" class="w-16 h-16"></i></div>
                    <h4 class="text-4xl font-black tracking-tighter uppercase text-center">Meracik Intelligence...</h4>
                </div>
                <div id="result-card" class="bg-white luxury-card p-12 md:p-24 relative overflow-hidden">
                    <div id="ai-output" class="prose prose-slate mb-20"></div>
                    <div class="flex justify-end border-t pt-10">
                        <button onclick="exportToWord()" class="btn-premium px-12 py-6 rounded-[2rem] text-xs font-black uppercase tracking-widest shadow-xl">
                            <i data-lucide="download" class="w-5 h-5"></i> Simpan Analisa
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <div id="api-settings-panel" class="hidden fixed inset-0 z-[120] flex items-center justify-center p-8 text-center">
        <div class="absolute inset-0 bg-slate-950/80 backdrop-blur-md" onclick="toggleApiSettings()"></div>
        <div class="w-full max-w-lg relative bg-white rounded-[3.5rem] p-16 shadow-2xl">
            <h3 class="text-4xl font-black mb-12 uppercase leading-none">Aktivasi<br><span class="text-blue-600 italic text-3xl">Strategic Engine</span></h3>
            <input type="password" id="api-key-input" placeholder="Paste API Key di sini..." class="elite-input w-full mb-10 text-center" />
            <button class="btn-premium w-full py-7 rounded-[2rem] font-black uppercase text-xs" onclick="verifyAndSaveApiKey()">Hubungkan</button>
            <button onclick="deleteApiKey()" class="w-full mt-6 text-rose-500 font-bold text-[10px] uppercase">Hapus Kunci</button>
        </div>
    </div>

    <!-- Help Panel -->
    <div id="help-panel" class="hidden fixed inset-0 z-[80] flex items-center justify-center p-8 text-center text-slate-900">
        <div class="absolute inset-0 bg-slate-950/90 backdrop-blur-xl" onclick="toggleHelp()"></div>
        <div class="w-full max-w-3xl relative bg-white rounded-[4rem] p-16 shadow-2xl max-h-[90vh] overflow-y-auto no-scrollbar">
            <h3 class="text-5xl font-black mb-6 uppercase tracking-tighter leading-none text-center">Panduan<br><span class="text-blue-600 italic">Intelligence</span></h3>
            <div class="space-y-12 text-left mt-16">
                <div class="relative pl-24">
                    <div class="absolute left-0 top-0 w-16 h-16 bg-blue-600 text-white rounded-3xl flex items-center justify-center font-black text-2xl shadow-xl">1</div>
                    <h4 class="text-2xl font-black text-slate-900 uppercase mb-4">Dapatkan API Key Gratis</h4>
                    <p class="text-slate-500 text-lg leading-relaxed mb-6 italic">Aplikasi ini butuh otak AI dari Google. Gratis!</p>
                    <div class="bg-slate-50 p-8 rounded-[2.5rem] border border-slate-100">
                        <p class="text-sm">• Buka <a href="https://aistudio.google.com/" target="_blank" class="text-blue-600 font-bold underline">Google AI Studio</a>.</p>
                        <p class="text-sm">• Klik <strong>"Get API key"</strong> -> <strong>"Create API key in new project"</strong>.</p>
                        <p class="text-sm">• Salin kodenya ke menu Pengaturan di sini.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAYjVPWSlY3I8DS9VTp28MrSDyva2Xj4N0",
            authDomain: "eliteseller-527fc.firebaseapp.com",
            projectId: "eliteseller-527fc",
            storageBucket: "eliteseller-527fc.firebasestorage.app",
            messagingSenderId: "179141358448",
            appId: "1:179141358448:web:f4b2260bbc88a2adaed5b5"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Bypass Logic: Function to force enter dashboard for Trial Mode
        const forceEnterDashboard = () => {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('app-content').classList.remove('hidden');
            if (typeof init === 'function') init();
        };

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                forceEnterDashboard();
            } else {
                document.getElementById('login-screen').classList.remove('hidden');
                document.getElementById('app-content').classList.add('hidden');
            }
        });

        window.handleLogin = async () => {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const btnText = document.getElementById('btn-login-text');
            const errBox = document.getElementById('login-error');
            const errMsg = document.getElementById('error-message-text');
            
            if (!email || !password) return;
            btnText.innerText = "AUTHENTICATING...";
            
            try { 
                await signInWithEmailAndPassword(auth, email, password); 
            } catch (err) { 
                console.warn("Auth Code:", err.code);
                // BYPASS if Auth provider is not enabled in Firebase Console
                if (err.code === 'auth/operation-not-allowed') {
                    forceEnterDashboard();
                } else {
                    errBox.classList.remove('hidden'); 
                    errMsg.innerText = "Email/Password salah Boss!";
                    btnText.innerText = "Masuk Sistem"; 
                }
            }
        }

        window.handleLogout = async () => { await signOut(auth); window.location.reload(); }
    </script>

    <script>
        const APP_FEATURES = [
            { id: 1, title: "Arsitek Mutasi Produk", value: "Strategic Portfolio Innovation", role: "Strategist", desc: "Bikin produk unik yang punya 'pagar gaib' biar kompetitor pusing mau tiru nggak bisa-bisa. Boss bakal main sendirian di pasar tanpa perlu perang harga!", prompt: (i) => `Analisa mutasi produk ${i.niche} di ${i.marketplace}. Kapabilitas: ${i.capability}. Target Margin: ${i.margin}. Target Audiens: ${i.target}. Berikan 3 konsep entry barrier tinggi.`, fields: [{ id: 'marketplace', label: 'Platform Utama', placeholder: 'Contoh: TikTok Shop / Shopee' }, { id: 'niche', label: 'Kategori Bisnis', placeholder: 'Contoh: Fashion Muslim Wanita' }, { id: 'capability', label: 'Kelebihan Internal', placeholder: 'Contoh: Punya workshop sendiri / Kain sisa ekspor eksklusif' }, { id: 'margin', label: 'Target Margin (%)', placeholder: 'Contoh: 40%' }, { id: 'target', label: 'Target Audiens', placeholder: 'Contoh: Ibu Muda 25-35th di Kota Besar' }] },
            { id: 2, title: "Optimasi Iklan & ROI", value: "Performance Audit", role: "Growth", desc: "Stop buang-buang duit! Kita audit biar iklan Boss jadi mesin pencetak uang yang efisien dengan biaya serendah mungkin tapi untung selangit.", prompt: (i) => `Audit Iklan ${i.platform}. Spend: ${i.spend}, Revenue: ${i.revenue}, Clicks: ${i.clicks}, Conversions: ${i.conversions}. Target ROAS: ${i.targetRoas}.`, fields: [{ id: 'platform', label: 'Platform Iklan', placeholder: 'Contoh: Meta Ads / TikTok Ads' }, { id: 'spend', label: 'Biaya Iklan (Rp)', placeholder: 'Contoh: 10000000' }, { id: 'revenue', label: 'Omzet Iklan (Rp)', placeholder: 'Contoh: 50000000' }, { id: 'clicks', label: 'Jumlah Klik', placeholder: 'Contoh: 5000' }, { id: 'targetRoas', label: 'Target ROAS', placeholder: 'Contoh: 5' }] },
            { id: 3, title: "Master Kolaborasi Brand", value: "Partnership Growth", role: "Partner", desc: "Dua kepala lebih baik dari satu. Kita cariin skema gandengan sama partner yang tepat biar brand Boss langsung jajah pasar baru tanpa ribet.", prompt: (i) => `Strategi Kolaborasi ${i.brand}. Partner Target: ${i.partner}. Tujuan: ${i.goal}. Budget: ${i.budget}.`, fields: [{ id: 'brand', label: 'Nama Brand Kamu', placeholder: 'Contoh: Kopi Boss' }, { id: 'partner', label: 'Target Partner', placeholder: 'Contoh: Brand Sepatu Lokal / Influencer Tekno' }, { id: 'goal', label: 'Goal Kolaborasi', placeholder: 'Contoh: Penetrasi ke pasar anak muda Jabodetabek' }, { id: 'budget', label: 'Budget Maksimal', placeholder: 'Contoh: 20000000' }] },
            { id: 4, title: "Sistem Kerajaan Afiliasi", value: "Reseller & Affiliate Hub", role: "Manager", desc: "Bangun pasukan jualan tanpa Boss harus gaji tiap bulan. Mereka yang pusing jualan, Boss tinggal fokus stok barang dan pantau cuan!", prompt: (i) => `Sistem Reseller ${i.product}. Harga Jual: ${i.price}. Komisi: ${i.comm}. Syarat Join: ${i.terms}. Support: ${i.support}.`, fields: [{ id: 'product', label: 'Produk', placeholder: 'Contoh: Skincare Whitening' }, { id: 'price', label: 'Harga Jual', placeholder: 'Contoh: 150000' }, { id: 'comm', label: 'Komisi Per Unit', placeholder: 'Contoh: 30000' }, { id: 'terms', label: 'Syarat Gabung', placeholder: 'Contoh: Stok minimal 10 paket' }, { id: 'support', label: 'Bantuan (Grup/Konten)', placeholder: 'Contoh: Grup WA & Bank Konten Harian' }] },
            { id: 5, title: "Pakar Cerita Jualan", value: "Sales Storytelling", role: "Writer", desc: "Jualan lewat cerita itu nggak berasa kayak jualan. Kita bikin pembeli Boss baper, tersentuh, lalu ujung-ujungnya bilang: 'Mau beli dong!'.", prompt: (i) => `Buat 15 cerita storytelling maut ${i.product}. Target: ${i.target}. Emosi Target: ${i.emotion}. Pesan Utama: ${i.message}.`, fields: [{ id: 'product', label: 'Produk', placeholder: 'Contoh: Kursus Ekspor' }, { id: 'target', label: 'Target Pembaca', placeholder: 'Contoh: Karyawan yang ingin resign' }, { id: 'emotion', label: 'Emosi Incaran', placeholder: 'Contoh: Harapan & Kebebasan Finansial' }, { id: 'message', label: 'Inti Pesan', placeholder: 'Contoh: Ekspor itu mudah asal tau caranya' }] },
            { id: 6, title: "Identitas Visual Mewah", value: "Premium Branding Personality", role: "Visual", desc: "Bikin toko Boss kelihatan 'Mahal' dan terpercaya. Orang nggak bakal berani tawar sadis kalau tampilan toko Boss sudah selevel brand internasional.", prompt: (i) => `Analisa Branding ${i.brand}. Core Value: ${i.value}. Karakter: ${i.char}. Target Persepsi: ${i.perception}.`, fields: [{ id: 'brand', label: 'Nama Toko', placeholder: 'Contoh: LuxuWear' }, { id: 'value', label: 'Value Utama', placeholder: 'Contoh: Eksklusivitas & Minimalisme' }, { id: 'char', label: 'Karakter Brand', placeholder: 'Contoh: Elegan, Misterius, Mahal' }, { id: 'perception', label: 'Kesan yg Diinginkan', placeholder: 'Contoh: Barang langka hanya untuk kalangan tertentu' }] },
            { id: 7, title: "Teknik Persuasi Jujur", value: "Ethical Psychological Selling", role: "Psych", desc: "Bikin pembeli merasa aman and nggak dibohongin. Kejujuran Boss justru bakal jadi magnet yang bikin mereka setia selamanya.", prompt: (i) => `Psikologi Jualan ${i.product}. Kelemahan Produk: ${i.weakness}. Solusi Utama: ${i.solution}. Trust Factor: ${i.trust}.`, fields: [{ id: 'product', label: 'Produk', placeholder: 'Contoh: Suplemen Herbal' }, { id: 'weakness', label: 'Kelemahan Produk', placeholder: 'Contoh: Hasil tidak instan, butuh 2 minggu' }, { id: 'solution', label: 'Solusi Terhebatnya', placeholder: 'Contoh: Tanpa efek samping dan permanen' }, { id: 'trust', label: 'Bukti/Testimoni Ada?', placeholder: 'Contoh: Sertifikasi BPOM & 500+ Testimoni' }] },
            { id: 8, title: "Copywriting Konversi", value: "Sales Conversion Copy", role: "Copywriter", desc: "Bikin tulisan penawaran yang kalau dibaca, orang nggak punya pilihan lain selain klik tombol 'Beli Sekarang'.", prompt: (i) => `Copywriting ${i.framework} untuk ${i.product}. USP: ${i.usp}. Masalah Pembeli: ${i.pain}. CTA: ${i.cta}.`, fields: [{ id: 'product', label: 'Nama Produk', placeholder: 'Contoh: Sepatu Lari Pro' }, { id: 'framework', label: 'Framework (AIDA/PAS)', placeholder: 'Contoh: AIDA (Attention, Interest, Desire, Action)' }, { id: 'usp', label: 'Kelebihan Unik', placeholder: 'Contoh: Sol empuk teknologi NASA' }, { id: 'pain', label: 'Masalah Utama Pembeli', placeholder: 'Contoh: Kaki cepat capek kalau lari jauh' }] },
            { id: 9, title: "Strategi Harga & Laba", value: "Pricing Engineering", role: "Finance", desc: "Main cantik dengan angka! Kita setting harga biar Boss tetap untung gede walaupun lagi ada promo besar-besaran.", prompt: (i) => `Pricing Strategy ${i.product}. COGS: ${i.cost}. Harga Saingan: ${i.comp}. Positioning: ${i.pos}. Target Profit: ${i.profit}.`, fields: [{ id: 'product', label: 'Produk', placeholder: 'Contoh: Keripik Pisang Premium' }, { id: 'cost', label: 'HPP (COGS)', placeholder: 'Contoh: 15000' }, { id: 'comp', label: 'Harga Lawan', placeholder: 'Contoh: 25000-35000' }, { id: 'pos', label: 'Positioning', placeholder: 'Contoh: Premium (Middle-Up)' }] },
            { id: 10, title: "Pawang Trafik & Viral", value: "Viral Loops & Growth", role: "Hacker", desc: "Nggak perlu iklan mahal-mahal kalau konten Boss bisa meledak organik. Kita cari celah gimana caranya algoritma jatuh cinta sama konten Boss!", prompt: (i) => `Viral Loop ${i.product}. Platform: ${i.platform}. Hook Ide: ${i.hook}. Emosi: ${i.emotion}. Format: ${i.format}. Target: ${i.target}.`, fields: [{ id: 'product', label: 'Produk', placeholder: 'Contoh: Alat Pel Otomatis' }, { id: 'platform', label: 'Platform Utama', placeholder: 'Contoh: TikTok Shop' }, { id: 'hook', label: 'Ide Headline', placeholder: 'Contoh: Jangan beli alat ini kalau nggak mau kecanduan ngepel!' }, { id: 'emotion', label: 'Emosi Target', placeholder: 'Contoh: Penasaran & Malu kalau rumah kotor' }] },
            { id: 11, title: "Audit Intelijen Saingan", value: "Competitor Blindspot", role: "Spy", desc: "Kenali musuhmu seperti dirimu sendiri. Kita cari celah dosa mereka buat jadi peluang pahala jualan Boss. Nikung pelanggan lawan jadi makin gampang!", prompt: (i) => `Market Intel. Lawan: ${i.comp}. Niche: ${i.niche}. Kelebihan Mereka: ${i.pros}. Keluhan Pembeli Mereka: ${i.cons}. Pola Promo Mereka: ${i.promo}.`, fields: [{ id: 'comp', label: 'Nama Kompetitor', placeholder: 'Contoh: Toko Hijab Sebelah' }, { id: 'niche', label: 'Niche Bisnis', placeholder: 'Contoh: Hijab Syari' }, { id: 'pros', label: 'Kekuatan Mereka', placeholder: 'Contoh: Model sangat variatif' }, { id: 'cons', label: 'Kelemahan Mereka', placeholder: 'Contoh: Respon chat lama & packing plastik tipis' }] },
            { id: 12, title: "Analisa SWOT & Celah", value: "Strategic SWOT Analysis", role: "Analyst", desc: "Cek kesehatan bisnis biar nggak kaget di tengah jalan. Kita mapping apa yang harus di-gas dan apa yang harus di-rem.", prompt: (i) => `SWOT Analyst ${i.biz}. Strengths: ${i.s}. Weaknesses: ${i.w}. Opportunities: ${i.o}. Threats: ${i.t}.`, fields: [{ id: 'biz', label: 'Nama Bisnis', placeholder: 'Contoh: Resto Ayam Geprek' }, { id: 's', label: 'Kekuatan Anda', placeholder: 'Contoh: Sambal resep rahasia paling enak' }, { id: 'w', label: 'Kelemahan Anda', placeholder: 'Contoh: Lokasi parkir sempit' }, { id: 'o', label: 'Peluang Luar', placeholder: 'Contoh: Banyak kantor baru buka di depan toko' }] },
            { id: 13, title: "Arsitek Positioning", value: "Unique Selling Proposition", role: "Brand", desc: "Bikin brand Boss punya 'kamar' sendiri di kepala pembeli. Boss nggak akan dibanding-bandingkan lagi sama kompetitor receh lainnya.", prompt: (i) => `Positioning ${i.brand}. Lawan: ${i.comp}. Celah: ${i.gap}. Tagline Ide: ${i.tag}.`, fields: [{ id: 'brand', label: 'Brand Kamu', placeholder: 'Contoh: Susu Kedelai Sehat' }, { id: 'comp', label: 'Kelemahan Lawan', placeholder: 'Contoh: Lawan pakai pengawet' }, { id: 'gap', label: 'Celah yg Belum Ada', placeholder: 'Contoh: Susu kedelai khusus ibu menyusui' }] },
            { id: 14, title: "Ritual Operasional", value: "Daily SOP & Ops", role: "Ops", desc: "Biar Boss bisa liburan tanpa HP berisik. Kita susun ritual biar tim kerja kayak robot yang rapi dan produktif.", prompt: (i) => `Daily SOP Admin ${i.platform}. Tim: ${i.team}. Task Utama: ${i.task}. Jam Aktif: ${i.hours}.`, fields: [{ id: 'platform', label: 'Platform Utama', placeholder: 'Contoh: Shopee & TikTok' }, { id: 'team', label: 'Jumlah Tim', placeholder: 'Contoh: 2 Admin Chat & 1 Admin Packing' }, { id: 'task', label: 'Tugas Utama', placeholder: 'Contoh: Balas chat & input resi' }] },
            { id: 15, title: "Guru Konversi Live", value: "Live Stream Sales Mastery", role: "Live", desc: "Bikin sesi Live Boss jadi tontonan yang menghibur sekaligus mesin cetak invoice. Penonton betah, stok habis!", prompt: (i) => `Skrip Live ${i.product}. Platform: ${i.platform}. Durasi: ${i.dur}. Promo Utama: ${i.promo}. Target Penonton: ${i.target}.`, fields: [{ id: 'product', label: 'Produk', placeholder: 'Contoh: Setelan Mukena Travel' }, { id: 'platform', label: 'Platform Live', placeholder: 'Contoh: TikTok Live' }, { id: 'promo', label: 'Promo Spesial Live', placeholder: 'Contoh: Diskon 20rb khusus 10 pembeli pertama' }] },
            { id: 16, title: "Arahan Visual Mewah", value: "Visual Direction", role: "Visual", desc: "Foto produk seadanya bikin orang males beli. Kita kasih arahan biar foto modal HP Boss kelihatan kayak hasil jepretan studio di Paris.", prompt: (i) => `Tips Foto HP ${i.product}. Lokasi: ${i.loc}. Lighting: ${i.light}. Properti: ${i.prop}.`, fields: [{ id: 'product', label: 'Produk', placeholder: 'Contoh: Tas Kulit Pria' }, { id: 'loc', label: 'Lokasi Foto', placeholder: 'Contoh: Meja Kayu Tua / Kafe Industrial' }, { id: 'light', label: 'Pencahayaan', placeholder: 'Contoh: Sinar matahari jam 4 sore (Golden Hour)' }] },
            { id: 17, title: "Rekayasa Reputasi", value: "Rating & Social Proof", role: "Review", desc: "Bikin toko Boss penuh bintang 5 tanpa kelihatan maksa. Rating bagus adalah magnet paling ngeri buat tarik pembeli baru!", prompt: (i) => `Review Strategy ${i.product}. Masalah Sering: ${i.issue}. Solusi: ${i.sol}. Cara Minta: ${i.ask}.`, fields: [{ id: 'product', label: 'Produk', placeholder: 'Contoh: Case iPhone Custom' }, { id: 'issue', label: 'Masalah Sering', placeholder: 'Contoh: Warna agak beda dikit sama di HP' }, { id: 'ask', label: 'Gaya Minta Ulasan', placeholder: 'Contoh: Akrab dan memberikan diskon next order' }] },
            { id: 18, title: "Manajemen Krisis", value: "Crisis Recovery", role: "CS", desc: "Saat ada komplain meledak, jangan panik! Kita kasih cara gimana caranya ngubah pembeli yang ngamuk jadi pembeli yang paling loyal.", prompt: (i) => `Crisis CS ${i.issue}. Kesalahan: ${i.error}. Kompensasi: ${i.comp}. Gaya Balasan: ${i.style}.`, fields: [{ id: 'issue', label: 'Masalah Pembeli', placeholder: 'Contoh: Barang pecah saat sampai' }, { id: 'error', label: 'Siapa yg Salah?', placeholder: 'Contoh: Ekspedisi tapi kita mau ganti' }, { id: 'style', label: 'Gaya Balasan', placeholder: 'Contoh: Tenang, Empati, dan Solutif' }] },
            { id: 19, title: "Master Interaksi", value: "Engagement Response", role: "CS", desc: "Kolom review adalah etalase kedua. Kita balesin ulasan biar calon pembeli lain makin yakin kalau Boss itu penjual yang sangat peduli.", prompt: (i) => `Balasan Ulasan Bintang ${i.stars}. Comment: ${i.comment}. Tone: ${i.tone}. CTA: ${i.cta}.`, fields: [{ id: 'stars', label: 'Bintang Berapa?', placeholder: 'Contoh: Bintang 1 / Bintang 5' }, { id: 'comment', label: 'Isi Komentar', placeholder: 'Contoh: Paket lama sekali sampainya!' }, { id: 'tone', label: 'Gaya Balasan', placeholder: 'Contoh: Ramah dan Profesional' }] },
            { id: 20, title: "Otomatisasi Hubungan", value: "Retention WA Automation", role: "CRM", desc: "Cari pelanggan baru itu mahal, urus pelanggan lama itu murah. Kita panggil lagi mereka yang sudah pernah beli biar belanja lagi dan lagi.", prompt: (i) => `Pesan WA Retensi ${i.product}. Alasan Chat: ${i.reason}. Promo Khusus: ${i.promo}. Link: ${i.link}.`, fields: [{ id: 'product', label: 'Produk Penawaran', placeholder: 'Contoh: Refill Sabun Mandi' }, { id: 'reason', label: 'Alasan Chat', placeholder: 'Contoh: Sudah 1 bulan sejak beli terakhir' }, { id: 'promo', label: 'Promo Khusus', placeholder: 'Contoh: Gratis Ongkir khusus hari ini' }] },
            { id: 21, title: "Master Plan Kampanye", value: "Marketing Campaign Roadmap", role: "Campaign", desc: "Jangan jualan dadakan! Kita susun rencana perang sebulan penuh biar momen gajian atau hari besar jadi ladang panen raya Boss.", prompt: (i) => `Master Plan Kampanye ${i.product}. Durasi: ${i.dur}. Budget: ${i.budget}. Target Order: ${i.target}.`, fields: [{ id: 'product', label: 'Produk Utama', placeholder: 'Contoh: Koleksi Lebaran 2024' }, { id: 'dur', label: 'Lama Kampanye', placeholder: 'Contoh: 14 Hari' }, { id: 'target', label: 'Target Order', placeholder: 'Contoh: 1000 Pcs' }] },
            { id: 22, title: "Ekspansi & Peluang", value: "Market Opportunity", role: "Growth", desc: "Cari 'Samudra Biru' baru! Kita intip di mana ada pasar yang butuh produk Boss tapi kompetitor Boss belum ada yang nongol di sana.", prompt: (i) => `Ekspansi Bisnis ${i.niche}. Kota/Wilayah: ${i.region}. Segmen Baru: ${i.segment}. Produk Cross-sell: ${i.cross}.`, fields: [{ id: 'niche', label: 'Bisnis Saat Ini', placeholder: 'Contoh: Frozen Food di Malang' }, { id: 'region', label: 'Wilayah Target', placeholder: 'Contoh: Surabaya & Sidoarjo' }, { id: 'segment', label: 'Siapa lagi yg butuh?', placeholder: 'Contoh: Katering Rumahan' }] },
            { id: 23, title: "Audit Visual Toko", value: "Storefront UX Audit", role: "Audit", desc: "Bersihin 'kerikil' di toko Boss. Kadang hal sepele kayak foto profil burem bikin pembeli lari. Kita audit biar profil Boss makin gahar!", prompt: (i) => `Audit Toko ${i.platform}. Kategori: ${i.cat}. Kekhawatiran: ${i.fear}. Trust Signal: ${i.trust}.`, fields: [{ id: 'platform', label: 'Platform', placeholder: 'Contoh: Instagram Business' }, { id: 'fear', label: 'Kenapa orang ragu beli?', placeholder: 'Contoh: Takut barang nggak asli karena terlalu murah' }, { id: 'trust', label: 'Trust Signal yg Ada', placeholder: 'Contoh: Link Shopee Mall / Testimoni Video' }] },
            { id: 24, title: "Loyalitas & Keranjang", value: "VVIP Experience & Retention", role: "CRM Specialist", desc: "Bosen sama sistem poin yang jadul? Kita ganti dengan sistem 'Privilege' yang bikin pembeli Boss merasa eksklusif. Dari akses produk rahasia sampe reward langka yang bikin mereka nggak mau ngelirik toko sebelah!", prompt: (i) => `Loyalty Strategist. Rancang ekosistem loyalitas modern untuk ${i.product}. Fokus pada pengalaman (Experience) dan Gengsi, bukan sekadar poin receh. Tingkatan: ${i.member}. Privilege Utama: ${i.privilege}. Reward Out-of-the-box (Gila/Langka): ${i.outBoxReward}. Buat skema yang membuat mereka merasa menjadi bagian dari 'Inner Circle' brand Boss.`, fields: [{ id: 'product', label: 'Produk Utama', placeholder: 'Contoh: Brand Fashion Lokal / Coffee Shop' }, { id: 'member', label: 'Level Membership', placeholder: 'Contoh: Inner Circle, Elite, Legend' }, { id: 'privilege', label: 'Privilege & VVIP Experience', placeholder: 'Contoh: Akses produk 24 jam lebih awal / Admin jalur cepat' }, { id: 'outBoxReward', label: "Reward 'Gila' & Langka", placeholder: 'Contoh: Mystery Box isi barang Limited / Undian Makan Malam Private' }] },
            { id: 25, title: "Target Strategis (KPI)", value: "Business Metrics & KPI", role: "Data", desc: "Bisnis tanpa angka itu kayak nyetir mata merem. Kita tentukan angka target biar tim Boss tahu seberapa kencang mereka harus lari!", prompt: (i) => `KPI Bisnis ${i.platform}. Omzet Target: ${i.target}. Profit Target: ${i.profit}. Jumlah Tim: ${i.team}.`, fields: [{ id: 'target', label: 'Target Omzet/Bulan', placeholder: 'Contoh: 100.000.000' }, { id: 'profit', label: 'Target Profit Bersih', placeholder: 'Contoh: 25.000.000' }, { id: 'team', label: 'Tim Saat Ini', placeholder: 'Contoh: 3 Orang' }] },
            { id: 26, title: "Persona Pembeli", value: "Buyer Persona & Psychographics", role: "Target", desc: "Pahami isi kepala pembeli Boss. Apa yang bikin mereka bangun malam-malam dan pengen beli barang Boss. Tembak tepat di jantung masalahnya!", prompt: (i) => `Buyer Persona ${i.product}. Masalah Utama: ${i.pain}. Impian: ${i.dream}. Umur & Status: ${i.demog}. Minat: ${i.interest}.`, fields: [{ id: 'product', label: 'Nama Produk', placeholder: 'Contoh: Mainan Edukasi Anak' }, { id: 'pain', label: 'Masalah Terbesarnya', placeholder: 'Contoh: Anak terlalu sering main gadget' }, { id: 'dream', label: 'Impian Hidupnya', placeholder: 'Contoh: Anak tumbuh cerdas dan kreatif' }] },
            { id: 27, title: "Funnel Iklan Konversi", value: "Ad Funnel Mapping", role: "Ads", desc: "Jaga pembeli di setiap langkah. Dari yang cuma liat-liat, sampe akhirnya transfer. Kita pasang jerat konversi yang rapi di setiap tahap!", prompt: (i) => `Ad Funnel ${i.product}. Budget: ${i.budget}. Platform: ${i.platform}. USP: ${i.usp}.`, fields: [{ id: 'product', label: 'Produk', placeholder: 'Contoh: Jasa SEO Agency' }, { id: 'budget', label: 'Estimasi Budget', placeholder: 'Contoh: 5.000.000' }, { id: 'platform', label: 'Fokus Iklan di Mana?', placeholder: 'Contoh: Google Ads & LinkedIn' }] },
            { id: 28, title: "Anggaran & Efisiensi", value: "Marketing Budgeting", role: "Finance", desc: "Hemat itu pangkal kaya. Kita bagi duit marketing Boss biar nggak ada yang terbuang sia-sia untuk hal yang nggak kasih impact.", prompt: (i) => `Budgeting ${i.product}. Budget Total: ${i.budget}. Prioritas: ${i.priority}. Periode: ${i.period}.`, fields: [{ id: 'budget', label: 'Total Budget', placeholder: 'Contoh: 2.000.000' }, { id: 'priority', label: 'Fokus Utama', placeholder: 'Contoh: 70% Sales, 30% Branding' }, { id: 'period', label: 'Jangka Waktu', placeholder: 'Contoh: Setiap Bulan' }] },
            { id: 29, title: "Radar Intelijen Tren", value: "Market Trend Watch", role: "Radar", desc: "Jangan ketinggalan kereta! Kita kasih tau apa yang lagi rame biar Boss bisa 'numpang tenar' dan jualan Boss ikut kebawa arus viral.", prompt: (i) => `Trend Intel ${i.niche}. Sumber Tren: ${i.source}. Prediksi: ${i.predict}. Langkah Kita: ${i.action}.`, fields: [{ id: 'niche', label: 'Niche', placeholder: 'Contoh: Gadget & Tech' }, { id: 'source', label: 'Fokus Pantau', placeholder: 'Contoh: TikTok & Google Trends' }] },
            { id: 30, title: "Riset Keyword SEO", value: "Keyword Intelligence", role: "SEO", desc: "Biar saat orang cari solusi, nama Boss yang pertama kali muncul di depan mata mereka. Muncul di atas berarti peluang cuan lebih besar!", prompt: (i) => `SEO Riset ${i.product} di ${i.platform}. Kompetisi: ${i.comp}. Target Volume: ${i.vol}. Kata Kunci Inti: ${i.core}.`, fields: [{ id: 'product', label: 'Produk', placeholder: 'Contoh: Meja Belajar Anak' }, { id: 'platform', label: 'Target Platform', placeholder: 'Contoh: Google & Shopee' }, { id: 'core', label: '1 Kata Kunci Utama', placeholder: 'Contoh: Meja Belajar Minimalis' }] },
            { id: 31, title: "Navigasi Algoritma", value: "Algorithm Engineering", role: "Tech", desc: "Algoritma medsos sering berubah-ubah kayak perasaan si doi. Kita kasih tau cara mainnya biar konten Boss disebar ke sebanyak mungkin orang!", prompt: (i) => `Algo Engineering ${i.platform} untuk ${i.product}. Update Terakhir: ${i.update}. Cara FYP: ${i.fyp}.`, fields: [{ id: 'platform', label: 'Platform', placeholder: 'Contoh: TikTok FYP' }, { id: 'product', label: 'Tema Konten', placeholder: 'Contoh: Life Hacks Rumah Tangga' }, { id: 'update', label: 'Update yg Kamu Tau', placeholder: 'Contoh: Durasi video disarankan di atas 1 menit' }] }
        ];

        let userApiKey = localStorage.getItem('jagojualan_api_key') || "";
        let activeTabId = -1;
        let inputs = {};

        function init() { renderTabs(); updateStatus(!!userApiKey); lucide.createIcons(); }
        function toggleApiSettings() { document.getElementById('api-settings-panel').classList.toggle('hidden'); }
        function toggleHelp() { document.getElementById('help-panel').classList.toggle('hidden'); }

        async function verifyAndSaveApiKey() {
            const input = document.getElementById('api-key-input').value.trim();
            if (!input) return;
            userApiKey = input;
            localStorage.setItem('jagojualan_api_key', input);
            updateStatus(true);
            toggleApiSettings();
        }

        function deleteApiKey() { userApiKey = ""; localStorage.removeItem('jagojualan_api_key'); updateStatus(false); toggleApiSettings(); }

        function updateStatus(isValid) {
            const warning = document.getElementById('api-warning');
            if (isValid && userApiKey) {
                document.getElementById('status-dot').className = "w-2 h-2 rounded-full bg-emerald-500 animate-pulse";
                document.getElementById('status-text').innerText = "Siap Bantu Boss!";
                if(warning) warning.classList.add('hidden');
            } else {
                document.getElementById('status-dot').className = "w-2 h-2 rounded-full bg-slate-300";
                document.getElementById('status-text').innerText = "Lagi Tidur";
                if(warning) warning.classList.remove('hidden');
            }
        }

        function renderTabs() {
            const nav = document.getElementById('feature-nav');
            if(!nav) return;
            nav.innerHTML = APP_FEATURES.map((f, idx) => `
                <button onclick="switchTab(${idx})" class="tab-btn px-8 py-4 transition-all rounded-2xl whitespace-nowrap text-center ${activeTabId === idx ? 'bg-slate-900 text-white font-bold active shadow-xl scale-105' : 'text-slate-400 hover:text-slate-900'}">
                    <span class="text-[11px] uppercase tracking-wider">${f.title}</span>
                </button>
            `).join('');
        }

        window.switchTab = function(idx) {
            activeTabId = idx; inputs = {};
            document.getElementById('result-container').classList.add('hidden');
            document.getElementById('generate-button-container').classList.remove('hidden');
            document.getElementById('form-area').classList.remove('hidden');
            renderTabs(); renderForm();
            const f = APP_FEATURES[idx];
            document.getElementById('feature-title').innerText = `${f.title}.`;
            document.getElementById('feature-value-info').innerText = f.value;
            document.getElementById('feature-role-desc').innerText = f.desc;
        }

        function renderForm() {
            const f = APP_FEATURES[activeTabId];
            if(!f) return;
            document.getElementById('dynamic-fields').innerHTML = f.fields.map(field => `
                <div class="space-y-4 animate-in">
                    <label class="block text-[11px] font-bold uppercase text-slate-400 ml-6">${field.label}</label>
                    <input type="text" oninput="inputs['${field.id}']=this.value" placeholder="${field.placeholder}" class="elite-input w-full shadow-sm" />
                </div>
            `).join('');
        }

        window.handleGenerate = async function() {
            if (!userApiKey) return toggleApiSettings();
            const f = APP_FEATURES[activeTabId];
            const resCon = document.getElementById('result-container');
            const loading = document.getElementById('loading-state');
            const resCard = document.getElementById('result-card');
            const output = document.getElementById('ai-output');
            resCon.classList.remove('hidden'); loading.classList.remove('hidden'); resCard.classList.add('hidden');
            
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${userApiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: f.prompt(inputs) }] }],
                        systemInstruction: { parts: [{ text: `Anda adalah Senior Strategic Advisor Bisnis. Jawaban harus sangat tajam, taktis, fokus profit & efisiensi. Gunakan Bahasa Indonesia profesional tapi tetap asik sebagai partner bisnis. DILARANG menggunakan markdown bintang (*), dollar ($), atau garis vertikal (|). Gunakan Bab (##), Sub (###), dan Penomoran. Rata kiri-kanan (justify).` }] }
                    })
                });
                const data = await response.json();
                const text = data.candidates[0].content.parts[0].text.replace(/[*$|]/g, '');
                output.innerHTML = text.replace(/^### (.*$)/gim, '<h3 class="text-2xl font-bold mb-4 mt-8">$1</h3>')
                                       .replace(/^## (.*$)/gim, '<h2 class="text-3xl font-black mb-6 mt-14 text-blue-600">$1</h2>')
                                       .replace(/\n/g, '<br>');
                loading.classList.add('hidden'); resCard.classList.remove('hidden');
                setTimeout(() => resCon.scrollIntoView({ behavior: 'smooth' }), 100);
            } catch {
                loading.classList.add('hidden'); resCard.classList.remove('hidden');
                output.innerHTML = "Gagal memproses Boss. Cek internet/API Key ya.";
            }
        }

        function exportToWord() {
            const content = document.getElementById('ai-output').innerHTML;
            const blob = new Blob(['\ufeff', content], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url; link.download = 'ProSbe_Analysis.doc';
            link.click();
        }
    </script>
</body>
</html>
