<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProSbe | The Strategic Intelligence Dashboard</title>
    
    <!-- Library Eksternal -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            --luxury-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.08);
            --glass-bg: rgba(255, 255, 255, 0.7);
        }

        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #f8fafc;
            color: #0f172a;
            scroll-behavior: smooth;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .animate-in { animation: fade-in-up 1s cubic-bezier(0.19, 1, 0.22, 1) forwards; }
        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .glass-header {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(226, 232, 240, 0.8);
        }

        .luxury-card {
            background: white;
            border-radius: 2.5rem;
            border: 1px solid rgba(241, 245, 249, 1);
            box-shadow: var(--luxury-shadow);
            transition: all 0.4s ease;
        }

        .luxury-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 40px 80px -15px rgba(0, 0, 0, 0.12);
        }

        .prose h2 { font-weight: 800; color: #1e3a8a; margin-top: 4rem; margin-bottom: 2rem; font-size: 2.5rem; letter-spacing: -0.025em; }
        .prose h3 { font-weight: 700; color: #1e293b; margin-top: 2.5rem; margin-bottom: 1.2rem; font-size: 1.75rem; }
        
        /* Mengatur Paragraf Rata Kiri-Kanan */
        .prose p { margin-bottom: 1.8rem; line-height: 1.9; color: #475569; font-size: 1.15rem; text-align: justify; text-justify: inter-word; }
        .prose strong { color: #2563eb; font-weight: 700; }
        
        .prose ol { counter-reset: item; padding-left: 0; margin-bottom: 3rem; }
        
        /* Mengatur List Rata Kiri-Kanan */
        .prose ol li { display: block; margin-bottom: 2rem; position: relative; padding-left: 4.5rem; line-height: 1.8; color: #334155; font-size: 1.15rem; text-align: justify; text-justify: inter-word; }
        .prose ol li::before { 
            content: counter(item); 
            counter-increment: item; 
            position: absolute; 
            left: 0; 
            top: -0.25rem; 
            width: 3.2rem; 
            height: 3.2rem; 
            background: #1e293b; 
            color: white; 
            border-radius: 1rem; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-weight: 800; 
            font-size: 1.1rem;
            box-shadow: 0 10px 20px -5px rgba(30, 41, 59, 0.3);
        }

        .elite-input {
            border: 2px solid transparent;
            background: #f1f5f9;
            border-radius: 1.5rem;
            padding: 1.5rem 2rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            font-size: 1.05rem;
        }
        .elite-input:focus {
            outline: none;
            border-color: #3b82f6;
            background: white;
            box-shadow: 0 0 0 5px rgba(59, 130, 246, 0.1);
        }

        .tab-btn {
            position: relative;
            transition: all 0.4s ease;
        }
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 4px;
            background: #3b82f6;
            border-radius: 10px;
        }

        .gradient-text {
            background: linear-gradient(to right, #0f172a, #1e40af);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .btn-premium {
            background: #0f172a;
            color: white;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        .btn-premium:hover {
            background: #1e40af;
            transform: scale(1.02);
            box-shadow: 0 20px 40px -10px rgba(30, 64, 175, 0.4);
        }
    </style>
</head>
<body class="selection:bg-blue-600 selection:text-white overflow-x-hidden">

    <!-- LOGIN SCREEN -->
    <div id="login-screen" class="min-h-screen flex items-center justify-center p-8 bg-slate-950 relative overflow-hidden">
        <div class="absolute top-[-20rem] left-[-10rem] w-[60rem] h-[60rem] bg-blue-600/20 rounded-full blur-[180px]"></div>
        <div class="absolute bottom-[-20rem] right-[-10rem] w-[60rem] h-[60rem] bg-indigo-600/20 rounded-full blur-[180px]"></div>

        <div class="w-full max-w-md relative z-10 animate-in text-center">
            <div class="mb-16">
                <div class="inline-block p-6 bg-white/5 border border-white/10 rounded-[3rem] mb-8 backdrop-blur-md">
                    <i data-lucide="shield-check" class="w-16 h-16 text-blue-500"></i>
                </div>
                <h2 class="text-6xl font-extrabold text-white tracking-tighter mb-4">Pro<span class="text-blue-500 font-light italic">Sbe</span></h2>
                <p class="text-slate-400 text-sm font-bold uppercase tracking-[0.3em] opacity-80">Asisten Bisnis Paling Pengertian</p>
            </div>

            <div class="space-y-6 text-left">
                <div class="space-y-2">
                    <label class="block text-[10px] font-bold uppercase tracking-widest text-slate-500 ml-6">EMAIL KAMU</label>
                    <input type="email" id="login-email" placeholder="contoh@email.com" class="w-full px-8 py-6 bg-white/5 border border-white/10 rounded-[2rem] text-white focus:outline-none focus:border-blue-500 focus:bg-white/10 transition-all font-semibold" />
                </div>
                <div class="space-y-2">
                    <label class="block text-[10px] font-bold uppercase tracking-widest text-slate-500 ml-6">KODE RAHASIA</label>
                    <input type="password" id="login-password" placeholder="••••••••" class="w-full px-8 py-6 bg-white/5 border border-white/10 rounded-[2rem] text-white focus:outline-none focus:border-blue-500 focus:bg-white/10 transition-all font-semibold" />
                </div>
                
                <button onclick="handleLogin()" id="btn-login-action" class="w-full bg-blue-600 hover:bg-blue-400 text-white font-extrabold py-7 rounded-[2rem] transition-all shadow-2xl shadow-blue-500/20 flex items-center justify-center gap-4 group mt-8">
                    <span class="uppercase tracking-widest text-xs">Buka Dasbor Bisnis</span>
                    <i data-lucide="arrow-right" class="w-5 h-5 group-hover:translate-x-1 transition-transform"></i>
                </button>
                <div id="login-error" class="text-rose-400 text-[10px] font-bold text-center mt-6 hidden p-5 bg-rose-400/10 rounded-2xl border border-rose-500/20">OPS! KAYAKNYA ADA YANG SALAH KETIK DEH.</div>
            </div>
        </div>
    </div>

    <!-- MAIN APP CONTENT -->
    <div id="app-content" class="hidden">
        <header class="sticky top-0 z-50 glass-header">
            <div class="max-w-7xl mx-auto px-8">
                <div class="flex items-center justify-between h-28">
                    <div class="flex items-center gap-4 cursor-pointer group" onclick="window.location.reload()">
                        <div class="w-12 h-12 bg-slate-900 rounded-2xl flex items-center justify-center text-white transition-transform group-hover:rotate-12">
                            <i data-lucide="shield-check" class="w-7 h-7"></i>
                        </div>
                        <div class="flex flex-col">
                            <h1 class="text-3xl font-black tracking-tighter uppercase leading-none">Pro<span class="text-blue-600 font-light italic">Sbe</span></h1>
                            <span class="text-[9px] font-bold text-slate-400 uppercase tracking-[0.5em] mt-1 text-left">Teman Jualan Kamu</span>
                        </div>
                    </div>
                    
                    <div class="flex items-center gap-6">
                        <div id="api-badge" class="hidden md:flex items-center gap-3 px-6 py-3 bg-emerald-50 text-emerald-600 rounded-full border border-emerald-100 text-[10px] font-black uppercase tracking-widest">
                            <div id="status-dot" class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_10px_#10b981]"></div>
                            <span id="status-text">Siap Bantu!</span>
                        </div>
                        <div class="flex items-center bg-slate-100 rounded-2xl p-1">
                            <button onclick="toggleApiSettings()" class="p-4 text-slate-500 hover:text-blue-600 transition-all rounded-xl hover:bg-white" title="Pengaturan">
                                <i data-lucide="settings" class="w-5 h-5"></i>
                            </button>
                            <button onclick="handleLogout()" class="p-4 text-rose-500 hover:bg-white rounded-xl transition-all" title="Keluar">
                                <i data-lucide="log-out" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <nav id="feature-nav" class="flex items-center gap-4 overflow-x-auto no-scrollbar pb-6 -mx-2 flex-nowrap"></nav>
            </div>
        </header>

        <main class="max-w-5xl mx-auto px-8 py-24">
            <div id="api-warning" class="hidden mb-16 animate-in">
                <div class="bg-blue-600 rounded-[3rem] p-16 text-center text-white relative overflow-hidden shadow-2xl">
                    <div class="absolute top-0 left-0 w-full h-full bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-10"></div>
                    <h4 class="text-3xl font-extrabold mb-4 uppercase tracking-tight relative z-10">Belum Bisa Mikir Nih...</h4>
                    <p class="text-blue-100 mb-10 text-lg relative z-10 max-w-xl mx-auto">Asisten kamu butuh "nyawa" (API Key) biar bisa mulai bikin strategi jualan yang maut buat kamu.</p>
                    <button onclick="toggleApiSettings()" class="bg-white text-blue-600 font-black px-12 py-5 rounded-2xl text-xs uppercase tracking-widest hover:bg-slate-100 transition-all relative z-10">Masukin Kodenya Sekarang</button>
                </div>
            </div>

            <!-- HERO SECTION -->
            <div class="mb-32 animate-in text-center md:text-left">
                <div class="inline-flex items-center gap-3 px-6 py-2.5 bg-blue-50 text-blue-700 rounded-full text-[10px] font-black uppercase tracking-[0.4em] mb-10 border border-blue-100">
                    <i data-lucide="sparkles" class="w-4 h-4"></i>
                    Buku Saku Jualan Laris
                </div>
                
                <div class="flex flex-col md:flex-row items-center md:items-start gap-8 mb-6">
                    <h2 id="feature-title" class="text-6xl md:text-8xl font-black tracking-tighter leading-none uppercase gradient-text">Mulai Aja Dulu.</h2>
                    <div class="info-container relative cursor-help hidden" id="feature-info-icon">
                        <div class="p-4 bg-slate-900 rounded-2xl text-white hover:bg-blue-600 transition-all shadow-xl">
                            <i data-lucide="info" class="w-6 h-6"></i>
                        </div>
                        <div class="tooltip-box text-left left-0">
                            <p class="font-bold text-blue-400 uppercase text-[10px] mb-2">BANTUAN CEPAT</p>
                            <span id="feature-description-text" class="text-sm">Pilih menu di atas buat dapet saran jualan yang pas banget buat kamu.</span>
                        </div>
                    </div>
                </div>

                <p id="feature-value-info" class="text-blue-600 font-extrabold text-2xl md:text-3xl uppercase tracking-tight mb-8 min-h-[1.5em]"></p>
                <p id="feature-role-desc" class="text-slate-500 text-xl md:text-2xl font-medium leading-relaxed max-w-3xl">Isi datanya, terus biarin asisten pinter kamu ini yang mikir keras buat bikin bisnis kamu makin cuan.</p>
            </div>

            <!-- INPUT SECTION -->
            <section id="form-area" class="mb-48 animate-in">
                <div id="dynamic-fields" class="grid grid-cols-1 gap-12 text-left"></div>
                <div id="generate-button-container" class="mt-20 hidden">
                    <button id="btn-generate" onclick="handleGenerate()" class="btn-premium flex items-center justify-center gap-6 py-10 px-20 rounded-[3rem] w-full text-center shadow-2xl">
                        <span id="btn-text" class="tracking-[0.5em] uppercase text-sm font-black">Bikinin Contekannya Dong!</span>
                        <i data-lucide="magic-wand" class="w-7 h-7"></i>
                    </button>
                </div>
            </section>

            <!-- RESULT SECTION -->
            <div id="result-container" class="hidden animate-in scroll-mt-24 pb-40">
                <div class="flex items-center gap-8 mb-24 opacity-20">
                    <div class="h-px flex-1 bg-slate-900"></div>
                    <span class="text-xs font-black uppercase tracking-[1.5em] text-center">Hasil Racikan ProSbe</span>
                    <div class="h-px flex-1 bg-slate-900"></div>
                </div>
                
                <div id="loading-state" class="hidden text-center py-20">
                    <div class="inline-block animate-spin mb-10 text-blue-600"><i data-lucide="loader-2" class="w-16 h-16"></i></div>
                    <h4 class="text-4xl font-black tracking-tighter uppercase gradient-text">Tunggu bentar, lagi diracik nih...</h4>
                </div>

                <div id="result-card" class="bg-white luxury-card p-12 md:p-24 overflow-hidden relative">
                    <div class="absolute top-0 right-0 p-12 opacity-[0.03]">
                        <i data-lucide="quote" class="w-64 h-64"></i>
                    </div>
                    <div id="ai-output" class="prose prose-slate mb-20 relative z-10"></div>
                    
                    <div class="flex flex-col md:flex-row justify-between items-center gap-12 pt-20 border-t border-slate-100 relative z-10">
                        <div class="flex items-center gap-6">
                            <div class="w-20 h-20 bg-emerald-500 rounded-3xl flex items-center justify-center shadow-2xl shadow-emerald-500/20 text-white">
                                <i data-lucide="check-circle" class="w-10 h-10"></i>
                            </div>
                            <div class="text-left">
                                <p class="text-[10px] font-black uppercase tracking-[0.4em] text-slate-400 mb-2">STATUS LAPORAN</p>
                                <p class="text-2xl font-black uppercase tracking-tight text-slate-900">Siap Dipakai Jualan!</p>
                            </div>
                        </div>
                        <button onclick="exportToWord()" class="btn-premium flex items-center gap-4 px-12 py-7 rounded-[2rem] text-xs font-black uppercase tracking-widest">
                            <i data-lucide="download" class="w-6 h-6"></i> Simpan ke File Word
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- SETTINGS MODAL -->
    <div id="api-settings-panel" class="hidden fixed inset-0 z-[60] flex items-center justify-center p-8">
        <div class="absolute inset-0 bg-slate-950/80 backdrop-blur-md" onclick="toggleApiSettings()"></div>
        <div class="w-full max-w-lg relative animate-in bg-white rounded-[3.5rem] p-16 shadow-2xl border border-white/20">
            <button onclick="toggleApiSettings()" class="absolute top-10 right-10 text-slate-300 hover:text-slate-900 transition-colors"><i data-lucide="x" class="w-8 h-8"></i></button>
            <h3 class="text-5xl font-black mb-4 tracking-tighter uppercase leading-none text-center">Aktivasi<br><span class="text-blue-600 italic">Otak AI</span></h3>
            <p class="text-center text-slate-500 font-medium mb-12">Authorized Access Only. Tempel kode API Google kamu di sini.</p>
            
            <div class="space-y-10">
                <div>
                    <label class="block text-[10px] font-black uppercase tracking-[0.4em] text-slate-400 ml-6 mb-4">KODE AKSES API</label>
                    <input type="password" id="api-key-input" placeholder="Tempel kode dari Google AI Studio..." class="elite-input w-full font-mono text-base bg-slate-50 shadow-inner" />
                </div>
                <div class="flex flex-col gap-6">
                    <button class="btn-premium w-full py-7 rounded-[2rem] font-black uppercase text-xs tracking-widest" onclick="verifyAndSaveApiKey()" id="btn-save-api">Inisialisasi Sistem</button>
                    <button onclick="deleteApiKey()" class="text-rose-500 font-black text-[10px] uppercase tracking-widest hover:underline text-center">Hapus Kode & Reset Sistem</button>
                </div>
                <div id="api-validation-msg" class="text-[10px] font-black uppercase hidden p-6 rounded-3xl text-center"></div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAYjVPWSlY3I8DS9VTp28MrSDyva2Xj4N0",
            authDomain: "eliteseller-527fc.firebaseapp.com",
            projectId: "eliteseller-527fc",
            storageBucket: "eliteseller-527fc.firebasestorage.app",
            messagingSenderId: "179141358448",
            appId: "1:179141358448:web:f4b2260bbc88a2adaed5b5"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        window.fbAuth = { auth, signInWithEmailAndPassword, signOut };

        onAuthStateChanged(auth, (user) => {
            const loginScreen = document.getElementById('login-screen');
            const appContent = document.getElementById('app-content');
            if (user) {
                loginScreen.classList.add('hidden');
                appContent.classList.remove('hidden');
                if (typeof init === 'function') init();
            } else {
                loginScreen.classList.remove('hidden');
                appContent.classList.add('hidden');
            }
        });
    </script>

    <script>
        const APP_FEATURES = [
            { id: 1, title: "Arsitek Mutasi Produk", value: "Bikin Produk Unik Biar Cepat Laris", role: "Teman Riset", desc: "Cari ide jualan yang unik dan nggak pasaran biar gampang laku di marketplace.", prompt: (i) => `Sebutin 50 ide produk unik dan menarik buat dijual di ${i.marketplace} dalam kategori ${i.niche}. Jelasin kenapa produk ini bakal laku. Bahasa santai ya!`, fields: [{ id: 'marketplace', label: 'Mau Jualan di Mana?', placeholder: 'TikTok, Shopee, IG...' }, { id: 'niche', label: 'Kategori Bisnis', placeholder: 'Fashion, Makanan, Alat Rumah...' }] },
            { id: 2, title: "Optimasi Iklan & ROI", value: "Diagnosa Iklan & Hitung Untung", role: "Dokter Iklan", desc: "Kasih tau data iklan kamu, nanti kita hitung ROI, CAC, CPA, PPC, CPL, CTR, dan CVR pake bahasa yang gampang dimengerti, plus cara A/B testing-nya.", prompt: (i) => `Bantu cek iklan di ${i.marketplace}. Biaya: ${i.spend}, Tayangan (Impression): ${i.impressions}, Klik: ${i.clicks}, Leads (Calon Pembeli): ${i.leads}, Order: ${i.orders}, Omzet: ${i.revenue}. HITUNG DAN JELASKAN secara simpel metrik ini: ROI, CAC, CPA, PPC, CPL, CTR, dan CVR. Kasih juga saran gimana cara A/B testing (tes iklan) biar makin meledak pengetahuannya. Bahasa santai ya!`, fields: [{ id: 'marketplace', label: 'Platform Iklan', placeholder: 'TikTok Ads, Shopee Ads...' }, { id: 'spend', label: 'Uang yang Keluar (Rp)', placeholder: 'Misal: 500000' }, { id: 'impressions', label: 'Jumlah Orang Liat (Impression)', placeholder: 'Misal: 100000' }, { id: 'clicks', label: 'Jumlah Orang Klik', placeholder: 'Misal: 2000' }, { id: 'leads', label: 'Berapa Calon Pembeli (Leads)', placeholder: 'Misal: 100' }, { id: 'orders', label: 'Berapa Orang Beli (Sales)', placeholder: 'Misal: 20' }, { id: 'revenue', label: 'Total Omzet (Rp)', placeholder: 'Misal: 2000000' }] },
            { id: 3, title: "Master Kolaborasi Brand", value: "Gandengan Biar Makin Terkenal", role: "Mak Comblang Bisnis", desc: "Cari tau cara asik buat kerja sama bareng brand atau orang lain.", prompt: (i) => `Gimana cara kolaborasi asik buat bisnis ${i.niche} di platform ${i.marketplace} bareng ${i.targetPartner}? Bikin strategi yang seru!`, fields: [{ id: 'marketplace', label: 'Main di Mana?', placeholder: 'IG, TikTok, WA...' }, { id: 'niche', label: 'Kategori Bisnis', placeholder: 'Skincare, Kopi...' }, { id: 'targetPartner', label: 'Mau Ajak Siapa?', placeholder: 'Influencer, Toko Sebelah...' }] },
            { id: 4, title: "Sistem Kerajaan Afiliasi", value: "Banyak Orang Bantuin Jual", role: "Bos Afiliasi", desc: "Bangun sistem biar orang lain seneng bantuin jualin produk kamu.", prompt: (i) => `Bantuin susun cara buat bikin tim reseller atau afiliasi buat produk ${i.productName} di ${i.marketplace}. Jelasin soal komisi dan cara ajak mereka.`, fields: [{ id: 'marketplace', label: 'Platformnya Apa?', placeholder: 'Shopee, TikTok...' }, { id: 'productName', label: 'Nama Produk Kamu', placeholder: 'Baju, Sambel, dll...' }] },
            { id: 5, title: "Pakar Cerita Jualan", value: "15 Racikan Cerita Pendek Maut", role: "Penulis Rayuan", desc: "Bikinin 15 variasi konten super singkat yang jual 'Harapan' pakai alur Masalah-Solusi-Hasil-CTA biar audiens nggak bosen.", prompt: (i) => `Buatkan tepat 15 variasi cerita pendek super singkat (maksimal 3-4 kalimat per cerita) untuk produk ${i.productName} di ${i.marketplace}. FOKUS: Jual 'Harapan' dan perubahan hidup. Alur: Hook -> Masalah -> Solusi -> CTA singkat. Gunakan ke-15 hook ini secara berurutan untuk ke-15 cerita:
            1. pernah kesal (...) solusinya ini sih (...)
            2. Hampir aja kecewa sama sellernya (...)
            3. Nyesel banget kenapa kemarin cuman beli 1 (...)
            4. Nggak bisa (...) kalau dilewatin begitu aja
            5. Baru tau ada (...) harganya cuman (...)
            6. (...) kamu harus banget sih punya
            7. Nyesel deh kalau gak punya (...)
            8. Gara-gara (...) aku jadi bisa
            9. cuman mau bilang (...)
            10. Solusi buat kamu yang suka (...)
            11. (kalian pada percaya nggak (...) kalau (...)
            12. Hari gini masih belum punya (...)
            13. Nggak heran lagi sih kalau (...) ini viral
            14. No debat, (...) ini terlalu cantik buat dilewatin
            15. Pliss deh, siapa sih yang bisa nolak (...) ini?
            Improvisasi bagian (...) sesuai produk. Bahasa sangat santai, akrab, dan bikin orang langsung mau klik.`, fields: [{ id: 'marketplace', label: 'Platform (Misal: TikTok)', placeholder: 'TikTok, IG Story...' }, { id: 'productName', label: 'Nama Produk', placeholder: 'Sabun, Hijab, Sepatu...' }] },
            { id: 6, title: "Pakar Identitas Visual", value: "Bedah Identitas Biar Gampang Diinget", role: "Penata Gaya Bisnis", desc: "Bikin toko kamu punya kepribadian yang kuat, mulai dari visual, gaya bahasa, sampe cara bikin pembeli ngerasa spesial.", prompt: (i) => `Bantu bangun identitas brand (Gaya Brand) yang mendalam dan unik untuk bisnis ${i.niche} di platform ${i.marketplace}. JELASKAN secara detail dalam format Bab dan Sub-Bab tentang: 
            ## Bab 1: Identitas Visual (Gimana toko kamu kelihatan).
            ## Bab 2: Gaya Bahasa & Komunikasi (Gimana toko kamu ngomong).
            ## Bab 3: Kepribadian Brand (Personality).
            ## Bab 4: Pengalaman Pelanggan (Customer Experience).
            Sebutkan juga 15 saran taktis singkat buat membedakan diri dari saingan. Gunakan bahasa santai tapi isinya "daging" semua. DILARANG pakai tabel atau garis vertikal.`, fields: [{ id: 'marketplace', label: 'Tempat Jualan Utama', placeholder: 'TikTok Shop, Shopee, Instagram...' }, { id: 'niche', label: 'Jenis Bisnis / Produk', placeholder: 'Aksesoris Handmade, Makanan Sehat...' }] },
            { id: 7, title: "Teknik Persuasi Jujur", value: "Jujur Malah Bikin Percaya", role: "Psikolog Jualan", desc: "Teknik jualan dengan jujur di awal yang malah bikin pembeli jatuh cinta.", prompt: (i) => `Gimana cara jualan jujur buat produk ${i.productName} tapi malah bikin orang percaya dan beli? Pakai teknik Recency Effect tapi jelasin secara simpel.`, fields: [{ id: 'productName', label: 'Produknya Apa?', placeholder: 'HP Bekas, Kue, dll...' }] },
            { id: 8, title: "Copywriting Konversi Tinggi", value: "Prasmanan Contoh Deskripsi Jualan", role: "Ahli Teks Jualan", desc: "Bikin tulisan penjelasan produk yang 'nendang' banget. Lengkap dengan banyak pilihan Judul Maut, alur Masalah-Solusi, gudang testimoni, dan Ajakan Beli yang beragam.", prompt: (i) => `Buatkan deskripsi produk lengkap (Prasmanan Contoh Copywriting) untuk ${i.productName} di ${i.marketplace}. Sampaikan dalam format Bab dengan CONTOH YANG MELIMPAH (isi daging semua): 
            ## Bab 1: Gudang Judul "Magnet" (Headline).
            ## Bab 2: 3 Skenario Masalah (Problem persona).
            ## Bab 3: Narasi Transformasi (Story Solusi).
            ## Bab 4: Daftar 7 Manfaat Tersembunyi (Benefits).
            ## Bab 5: 5 Variasi Testimoni Natural (Social Proof).
            ## Bab 6: 3 Gaya Ajakan Beli (CTA).
            DILARANG menggunakan tabel atau garis vertikal. Gunakan bahasa santai, akrab.`, fields: [{ id: 'marketplace', label: 'Jualan di Mana?', placeholder: 'Shopee, TikTok, Website...' }, { id: 'productName', label: 'Nama Produk Lengkap', placeholder: 'Gamis Crinkle Premium, Kopi Diet Sehat...' }] },
            { id: 9, title: "Strategi Harga & Laba", value: "Harga Pas, Untung Jelas", role: "Ahli Hitung Untung", desc: "Ngitung harga jual biar kamu nggak rugi tapi pembeli ngerasa murah.", prompt: (i) => `Bantu hitung harga jual buat ${i.productName}. Modalnya ${i.cost} dan saingan jual seharga ${i.compPrice}. Kasih saran harga coret juga.`, fields: [{ id: 'productName', label: 'Produk Apa?', placeholder: 'Kopi, Kaos...' }, { id: 'cost', label: 'Modal Kamu (Rp)', placeholder: '50000' }, { id: 'compPrice', label: 'Harga Tetangga (Rp)', placeholder: '100000' }] },
            { id: 10, title: "Pawang Trafik & Viral", value: "Bikin Toko Rame Pengunjung", role: "Pawang Trafik", desc: "Cara dapetin banyak pengunjung ke toko kamu, baik yang gratisan maupun bayar.", prompt: (i) => `Gimana caranya biar toko ${i.productName} di ${i.marketplace} rame yang liat? Kasih tips SEO simpel dan cara viral.`, fields: [{ id: 'marketplace', label: 'Platform Utama', placeholder: 'Shopee, TikTok...' }, { id: 'productName', label: 'Nama Barangnya', placeholder: 'Casing HP, dll...' }] },
            { id: 11, title: "Audit Intelijen Saingan", value: "Bedah Strategi Tikung Lawan", role: "Agen Rahasia Bisnis", desc: "Bongkar kelemahan sistemik sainganmu dan cari celah 'Blindspot' yang bisa kamu manfaatin buat menang telak.", prompt: (i) => `Bertindaklah sebagai Senior Strategic Spy. Bantu saya membedah kompetitor di niche ${i.niche} pada platform ${i.marketplace}. Sampaikan hasil analisa dalam format Bab yang "daging" banget: 
            ## Bab 1: Bedah Strategi Harga & Promo Lawan.
            ## Bab 2: Harta Karun Ulasan Negatif.
            ## Bab 3: Gaya Konten & Komunikasi.
            ## Bab 4: Blindspot (Celah yang Terlewat).
            ## Bab 5: 10 Jurus Tikung Pasar.
            Jangan pake tabel, jangan pake garis vertikal. Gunakan bahasa santai.`, fields: [{ id: 'marketplace', label: 'Marketplace Utama', placeholder: 'Shopee, TikTok, Tokopedia...' }, { id: 'niche', label: 'Niche Bisnis Kamu', placeholder: 'Skincare Jerawat, Sepatu Kulit Lokal...' }] },
            { id: 12, title: "Analisa SWOT & Celah Bisnis", value: "Tau Diri Biar Makin Hebat", role: "Penasihat Bisnis", desc: "Analisa apa yang oke dan apa yang harus diperbaiki dari bisnis kamu.", prompt: (i) => `Lakukan Analisa SWOT (Kelebihan, Kekurangan, Peluang, Tantangan) yang gampang dimengerti buat bisnis ${i.niche} di ${i.marketplace}.`, fields: [{ id: 'marketplace', label: 'Marketplace', placeholder: 'TikTok, Shopee...' }, { id: 'niche', label: 'Jenis Bisnis', placeholder: 'Jasa Desain, Jualan Snack...' }] },
            { id: 13, title: "Diferensiasi Nilai Unik", value: "Kenapa Harus Beli di Kamu?", role: "Ahli Beda", desc: "Cari satu alasan kuat kenapa orang harus beli di tempat kamu, bukan tempat lain.", prompt: (i) => `Cari alasan unik kenapa orang wajib beli ${i.productName} di toko saya, bukan di toko lain yang ${i.competitor}.`, fields: [{ id: 'productName', label: 'Nama Produk', placeholder: 'Kue Lebaran...' }, { id: 'competitor', label: 'Kelemahan Saingan?', placeholder: 'Lama kirimnya, mahal, dll...' }] },
            { id: 14, title: "Ritual Operasional Harian", value: "Kerja Teratur, Hasil Makmur", role: "Mandor Toko", desc: "Jadwal harian biar toko kamu keurus dengan bener dan nggak keteteran.", prompt: (i) => `Buatkan jadwal kerja harian yang simpel buat admin toko di ${i.marketplace}. Apa aja yang harus dilakuin tiap jam?`, fields: [{ id: 'marketplace', label: 'Jualan di Mana?', placeholder: 'Shopee, TikTok...' }] },
            { id: 15, title: "Guru Konversi Live", value: "Bikin Orang Nge-Checkout Pas Live", role: "Guru Live Streaming", desc: "Kata-kata sakti pas kamu lagi Live biar yang nonton langsung beli.", prompt: (i) => `Bikinin skrip atau poin-poin ngomong pas Live buat jual ${i.productName} di ${i.platform}. Bahasa santai dan bikin seru!`, fields: [{ id: 'productName', label: 'Produk Buat Live', placeholder: 'Daster, Alat Masak...' }, { id: 'platform', label: 'Live Di Mana?', placeholder: 'TikTok Live, Shopee Live...' }] },
            { id: 16, title: "Arahan Visual Mewah", value: "Barang Murah Jadi Mewah", role: "Fotografer HP", desc: "Tips foto produk pake HP aja tapi hasilnya kayak di studio mahal.", prompt: (i) => `Kasih tips foto produk ${i.productName} biar keliatan mewah cuma modal HP. Jelasin soal lampu dan background.`, fields: [{ id: 'productName', label: 'Nama Produk', placeholder: 'Jam Tangan, Tas...' }] },
            { id: 17, title: "Rekayasa Reputasi & Ulasan", value: "Biar Pembeli Kasih Ulasan Bagus", role: "Pengejar Bintang", desc: "Cara halus minta pembeli kasih ulasan bagus dan foto produk di penilaian.", prompt: (i) => `Gimana caranya biar pembeli ${i.productName} di ${i.marketplace} mau kasih bintang 5 tanpa kita maksa?`, fields: [{ id: 'marketplace', label: 'Platform', placeholder: 'Shopee, TikTok...' }, { id: 'productName', label: 'Nama Barangnya', placeholder: 'Masker Wajah, dll...' }] },
            { id: 18, title: "Manajemen Krisis & Komplain", value: "Ubah Pembeli Marah Jadi Langganan", role: "Peredam Amarah", desc: "Cara bales chat pembeli yang lagi ngamuk biar mereka malah jadi sayang sama toko kamu.", prompt: (i) => `Gimana cara bales komplain soal ${i.issue} biar pembeli nggak marah lagi?`, fields: [{ id: 'issue', label: 'Ada Masalah Apa?', placeholder: 'Barang pecah, salah warna...' }] },
            { id: 19, title: "Rencana Master Interaksi", value: "Bales Ulasan dengan Ramah", role: "Admin Baik Hati", desc: "Contoh balesan ulasan yang bikin toko kamu keliatan profesional tapi akrab.", prompt: (i) => `Bantuin bales ulasan bintang ${i.stars} yang bilang: "${i.comment}".`, fields: [{ id: 'stars', label: 'Bintang Berapa?', placeholder: '1-5...' }, { id: 'comment', label: 'Isi Ulasannya', placeholder: 'Barangnya cepet sampe tapi...' }] },
            { id: 20, title: "Otomatisasi Hubungan Pelanggan", value: "Bikin Pembeli Balik Lagi", role: "Sahabat Pelanggan", desc: "Cara hubungin pembeli lama lewat WA atau Email biar mereka mau beli lagi.", prompt: (i) => `Bikinin pesan WA yang asik buat nawarin ${i.productName} ke pembeli lama.`, fields: [{ id: 'productName', label: 'Produk yang Ditawarin', placeholder: 'Voucher Diskon, Koleksi Baru...' }] },
            { id: 21, title: "Strategi Kampanye Kilat", value: "Strategi Ikut Tanggal Kembar", role: "Ahli Promo", desc: "Cara manfaatin tanggal kembar (seperti 12.12) buat ledakin penjualan.", prompt: (i) => `Bikin strategi buat ikutan event besar buat produk ${i.productName} di ${i.marketplace}.`, fields: [{ id: 'marketplace', label: 'Platformnya', placeholder: 'Shopee, TikTok...' }, { id: 'productName', label: 'Nama Produk', placeholder: 'Sepatu, Tas...' }] },
            { id: 22, title: "Ekspansi Bisnis & Skala", value: "Makin Gede, Makin Cuan", role: "Ahli Cabang", desc: "Saran jualan produk lain yang masih nyambung sama jualan kamu sekarang.", prompt: (i) => `Saya jualan ${i.niche} di ${i.marketplace}. Kasih saran 20 barang lain yang masih nyambung.`, fields: [{ id: 'marketplace', label: 'Platform', placeholder: 'Shopee, TikTok...' }, { id: 'niche', label: 'Jualan Sekarang', placeholder: 'Baju Anak...' }] },
            { id: 23, title: "Audit Visual & Konversi", value: "Toko Rapih, Pembeli Betah", role: "Dekorator Toko", desc: "Audit tampilan profil toko kamu biar orang ngerasa aman beli di situ.", prompt: (i) => `Cek dong gimana tampilan toko yang bagus buat kategori ${i.category} di ${i.marketplace}.`, fields: [{ id: 'marketplace', label: 'Platform', placeholder: 'Shopee, TikTok...' }, { id: 'category', label: 'Kategori Jualan', placeholder: 'Kebutuhan Ibu & Bayi...' }] },
            { id: 24, title: "Loyalitas Pelanggan Abadi", value: "Satu Orang Beli Terus-terusan", role: "Pawang Langganan", desc: "Rahasia biar orang nggak cuma beli sekali, tapi balik lagi tiap bulan.", prompt: (i) => `Gimana caranya biar pembeli ${i.productName} jadi pelanggan setia seumur hidup?`, fields: [{ id: 'productName', label: 'Nama Produk', placeholder: 'Skincare, Kopi Bubuk...' }, { id: 'niche', label: 'Kategori Bisnis', placeholder: 'Kesehatan, Hobi...' }] },
            { id: 25, title: "Dasbor Target Strategis", value: "Ukur Keberhasilan Bisnis Kamu", role: "Penasihat Target", desc: "Tentukan target yang masuk akal dan pantau apakah bisnis kamu beneran makin sehat atau cuma sibuk doang.", prompt: (i) => `Bertindaklah sebagai Ahli Strategi Bisnis. Bantu saya menentukan dan memahami KPI (Indikator Keberhasilan) untuk bisnis di platform ${i.marketplace}. Fokus saat ini adalah: ${i.goal}. Saat ini kondisi saya: ${i.currentStatus}. JELASKAN secara detail dalam format Bab: 
            ## Bab 1: Angka yang Wajib Dipelototi.
            ## Bab 2: Target yang Masuk Akal.
            ## Bab 3: Cara Bedah Data.
            ## Bab 4: Strategi Naikin Angka.
            Gunakan bahasa yang sangat santai, akrab. DILARANG pakai tabel atau garis.`, fields: [{ id: 'marketplace', label: 'Jualan di Mana?', placeholder: 'TikTok, Shopee, Tokopedia...' }, { id: 'goal', label: 'Apa Target Utama Kamu?', placeholder: 'Naikin omzet, dapet pelanggan baru, atau gedein profit?' }, { id: 'currentStatus', label: 'Gimana Kondisi Sekarang?', placeholder: 'Baru mulai, atau sudah jalan tapi omzet mentok?' }] }
        ];

        let userApiKey = localStorage.getItem('jagojualan_api_key') || "";
        let activeTabId = -1;
        let inputs = {};
        let resultText = "";

        async function handleLogin() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const errorDiv = document.getElementById('login-error');
            const btn = document.getElementById('btn-login-action');
            if (!email || !password) return;
            btn.disabled = true; btn.innerText = "SABAR YA, LAGI DICEK...";
            try {
                await window.fbAuth.signInWithEmailAndPassword(window.fbAuth.auth, email, password);
            } catch (err) {
                errorDiv.classList.remove('hidden');
                btn.disabled = false; btn.innerText = "BUKA DASBOR BISNIS";
            }
        }

        async function handleLogout() { 
            try { 
                await window.fbAuth.signOut(window.fbAuth.auth); 
                window.location.reload();
            } catch (err) { console.error(err); } 
        }

        window.init = function() {
            renderTabs();
            updateStatus(!!userApiKey);
            lucide.createIcons();
        }

        function toggleApiSettings() { document.getElementById('api-settings-panel').classList.toggle('hidden'); }

        async function verifyAndSaveApiKey() {
            const input = document.getElementById('api-key-input').value.trim();
            const msg = document.getElementById('api-validation-msg');
            if (!input) return;
            msg.classList.remove('hidden', 'text-emerald-600', 'text-rose-600');
            msg.innerText = "Lagi nyoba konek...";
            msg.className = "text-[10px] font-bold uppercase p-6 rounded-3xl text-center bg-slate-900 text-white";
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${input}`);
                if (response.ok) {
                    userApiKey = input;
                    localStorage.setItem('jagojualan_api_key', input);
                    msg.innerText = "✓ Berhasil! Otaknya udah nyambung.";
                    msg.classList.add('text-emerald-400');
                    updateStatus(true);
                    setTimeout(() => toggleApiSettings(), 1200);
                } else { throw new Error(); }
            } catch {
                msg.innerText = "⚠ Gagal konek. Cek kodenya lagi ya.";
                msg.classList.add('text-rose-400');
                updateStatus(false);
            }
        }

        function deleteApiKey() { userApiKey = ""; localStorage.removeItem('jagojualan_api_key'); updateStatus(false); toggleApiSettings(); }

        function updateStatus(isValid) {
            const dot = document.getElementById('status-dot');
            const text = document.getElementById('status-text');
            const warning = document.getElementById('api-warning');
            if (isValid && userApiKey) {
                if(dot) dot.className = "w-2 h-2 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_10px_#10b981]";
                if(text) text.innerText = "Siap Bantu!";
                if(warning) warning.classList.add('hidden');
            } else {
                if(dot) dot.className = "w-2 h-2 rounded-full bg-slate-300";
                if(text) text.innerText = "Lagi Tidur";
                if(warning) warning.classList.remove('hidden');
            }
        }

        function renderTabs() {
            const nav = document.getElementById('feature-nav');
            nav.innerHTML = APP_FEATURES.map((f, idx) => `
                <button onclick="switchTab(${idx})" class="tab-btn px-8 py-4 transition-all rounded-2xl whitespace-nowrap text-center ${activeTabId === idx ? 'bg-slate-900 text-white shadow-2xl scale-105 font-bold active' : 'text-slate-400 hover:text-slate-900 hover:bg-slate-100'}">
                    <span class="text-[11px] uppercase tracking-wider">${f.title}</span>
                </button>
            `).join('');
        }

        window.switchTab = function(idx) {
            activeTabId = idx; inputs = {};
            document.getElementById('result-container').classList.add('hidden');
            document.getElementById('generate-button-container').classList.remove('hidden');
            document.getElementById('feature-info-icon').classList.remove('hidden');
            renderTabs(); renderForm();
            const f = APP_FEATURES[idx];
            document.getElementById('feature-title').innerText = `${f.title}.`;
            document.getElementById('feature-value-info').innerText = f.value;
            document.getElementById('feature-role-desc').innerText = f.desc;
            document.getElementById('feature-description-text').innerText = `Otoritas akses ke modul: ${f.title}`;
            lucide.createIcons();
        }

        function renderForm() {
            const f = APP_FEATURES[activeTabId];
            if(!f) return;
            document.getElementById('dynamic-fields').innerHTML = f.fields.map(field => `
                <div class="space-y-4 animate-in">
                    <label class="block text-[11px] font-bold uppercase tracking-[0.2em] text-slate-400 ml-6 text-left">${field.label}</label>
                    <input type="text" oninput="inputs['${field.id}']=this.value" placeholder="${field.placeholder}" class="elite-input w-full shadow-sm" />
                </div>
            `).join('');
        }

        window.handleGenerate = async function() {
            if (!userApiKey) return toggleApiSettings();
            const f = APP_FEATURES[activeTabId];
            const resCon = document.getElementById('result-container');
            const loading = document.getElementById('loading-state');
            const resCard = document.getElementById('result-card');
            const output = document.getElementById('ai-output');
            
            resCon.classList.remove('hidden'); loading.classList.remove('hidden'); resCard.classList.add('hidden');
            
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${userApiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: f.prompt(inputs) }] }],
                        systemInstruction: { parts: [{ text: `Jawab dalam bahasa Indonesia yang santai, akrab seperti teman curhat, tapi isinya cerdas dan berbobot. Jangan pakai istilah teknis ribet tanpa penjelasan gampang. Sampaikan informasi dalam format Bab Utama (##), Sub-pembahasan (###), dan Penomoran Langkah (1, 2, 3). DILARANG pakai tabel atau garis vertikal/horizontal. Pastikan isinya "daging" semua, detail, dan kasih banyak contoh nyata. Hasil tulisan harus terlihat rapi dengan paragraf yang jelas dan rata kiri-kanan (justify).` }] }
                    })
                });
                const data = await response.json();
                resultText = data.candidates[0].content.parts[0].text;
                output.innerHTML = formatText(resultText);
                loading.classList.add('hidden'); resCard.classList.remove('hidden');
                setTimeout(() => resCon.scrollIntoView({ behavior: 'smooth' }), 100);
            } catch {
                output.innerHTML = "<p class='text-center py-20 text-rose-500 font-bold'>Aduh, otaknya lagi pusing. Coba lagi bentar ya!</p>";
                loading.classList.add('hidden'); resCard.classList.remove('hidden');
            }
        }

        function formatText(t) {
            let clean = t.replace(/^-{3,}$/gm, '').replace(/^={3,}$/gm, '').replace(/^_{3,}$/gm, '').replace(/\|/g, '');
            let html = clean.replace(/^### (.*$)/gim, '<h3 class="text-2xl font-bold mb-4 mt-12 text-slate-900">$1</h3>')
                           .replace(/^## (.*$)/gim, '<h2 class="text-3xl font-black mb-8 mt-20 text-blue-600">$1</h2>');
            html = html.replace(/^\d+\.\s+(.*$)/gim, '<li>$1</li>');
            html = html.replace(/(<li>.*<\/li>)+/gim, (match) => `<ol>${match}</ol>`);
            html = html.replace(/\*\*(.*)\*\*/gim, '<strong class="text-blue-500">$1</strong>');
            let paragraphs = html.split('\n\n').map(p => {
                if (p.trim().startsWith('<h') || p.trim().startsWith('<ol')) return p;
                return `<p class="mb-8">${p.trim()}</p>`;
            }).join('');
            return paragraphs;
        }

        window.exportToWord = function() {
            const aiOutput = document.getElementById('ai-output');
            const feature = APP_FEATURES[activeTabId];
            const header = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
                <head><meta charset='utf-8'><title>Laporan Jualan ProSbe</title>
                <style>
                    body { font-family: 'Arial', sans-serif; line-height: 1.6; padding: 50px; color: #1e293b; }
                    h2 { color: #1e40af; font-size: 20pt; border-bottom: 2px solid #3b82f6; padding-bottom: 10px; margin-top: 30pt; }
                    h3 { color: #0f172a; font-size: 16pt; margin-top: 20pt; }
                    ol { padding-left: 30px; }
                    li { margin-bottom: 15px; text-align: justify; }
                    p { text-align: justify; margin-bottom: 12pt; }
                </style>
                </head><body>
                    <h1 style="text-align:center; color:#0f172a; text-transform:uppercase;">Analisa Strategis: ${feature.title}</h1>
                    <div class="content">${aiOutput.innerHTML}</div>
                </body></html>
            `;
            const blob = new Blob(['\ufeff', header], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url; link.download = `ProSbe_Analisa_${feature.title.replace(/\s+/g, '_')}.doc`;
            document.body.appendChild(link); link.click(); document.body.removeChild(link);
        }
    </script>
</body>
</html>
