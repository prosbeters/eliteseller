<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JagoJualan.PRO Elite Edition | The Seller's Handbook</title>
    <!-- Library Eksternal -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK - Modular -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAYjVPWSlY3I8DS9VTp28MrSDyva2Xj4N0",
            authDomain: "eliteseller-527fc.firebaseapp.com",
            projectId: "eliteseller-527fc",
            storageBucket: "eliteseller-527fc.firebasestorage.app",
            messagingSenderId: "179141358448",
            appId: "1:179141358448:web:f4b2260bbc88a2adaed5b5"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        window.fbAuth = { auth, signInWithEmailAndPassword, signOut };

        onAuthStateChanged(auth, (user) => {
            const loginScreen = document.getElementById('login-screen');
            const appContent = document.getElementById('app-content');
            const emailInput = document.getElementById('login-email');
            const passInput = document.getElementById('login-password');

            if (user) {
                loginScreen.classList.add('hidden');
                appContent.classList.remove('hidden');
                if (typeof init === 'function') init();
            } else {
                if(emailInput) emailInput.value = "";
                if(passInput) passInput.value = "";
                loginScreen.classList.remove('hidden');
                appContent.classList.add('hidden');
            }
        });
    </script>

    <style>
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #FDFDFF;
            scroll-behavior: smooth;
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .animate-in { animation: fade-in-up 0.8s cubic-bezier(0.19, 1, 0.22, 1) forwards; }
        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .text-justify { text-align: justify; text-justify: inter-word; }

        .prose { max-width: none; width: 100%; }
        .prose h1, .prose h2, .prose h3 { font-weight: 800; color: #0f172a; margin-top: 4rem; margin-bottom: 2rem; text-align: left; }
        .prose p { margin-bottom: 2.2rem; line-height: 2.3; color: #2c3e50; text-align: justify; font-size: 1.2rem; }
        .prose strong { color: #000; font-weight: 800; border-bottom: 2px solid #3b82f622; }
        .prose ul, .prose ol { margin-bottom: 3rem; padding: 0; }
        .prose li { margin-bottom: 1.8rem; color: #2c3e50; text-align: justify; list-style: none; position: relative; padding-left: 3rem; font-size: 1.2rem; line-height: 2.2; }
        .prose li::before { content: "▸"; position: absolute; left: 0; color: #3b82f6; font-size: 1.5rem; font-weight: 900; top: -0.1rem; }

        .elite-input {
            border: none;
            background: #F8FAFF;
            border-radius: 2rem;
            padding: 2rem 2.5rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.02);
            font-weight: 600;
            font-size: 1.2rem;
        }
        .elite-input:focus {
            outline: none;
            background: #ffffff;
            box-shadow: 0 25px 50px -12px rgba(59, 130, 246, 0.15);
            transform: translateY(-4px);
        }

        .tooltip-box {
            display: none;
            position: absolute;
            z-index: 100;
            background: #0f172a;
            color: white;
            padding: 1.5rem;
            border-radius: 1.5rem;
            width: 280px;
            font-size: 0.9rem;
            line-height: 1.6;
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.3);
            margin-top: 10px;
        }
        .info-container:hover .tooltip-box { display: block; }
    </style>
</head>
<body class="text-slate-900 selection:bg-blue-600 selection:text-white overflow-x-hidden">

    <!-- LOGIN SCREEN -->
    <div id="login-screen" class="min-h-screen flex items-center justify-center p-8 bg-slate-950 relative overflow-hidden">
        <div class="absolute -top-64 -left-64 w-[70rem] h-[70rem] bg-blue-600/10 rounded-full blur-[220px]"></div>
        <div class="absolute -bottom-64 -right-64 w-[70rem] h-[70rem] bg-indigo-600/10 rounded-full blur-[220px]"></div>

        <div class="w-full max-w-sm relative z-10 animate-in text-center">
            <div class="mb-20">
                <div class="inline-flex p-6 bg-white/5 backdrop-blur-3xl rounded-[2.8rem] border border-white/10 mb-10 shadow-2xl">
                    <i data-lucide="book-open" class="w-14 h-14 text-blue-400"></i>
                </div>
                <h2 class="text-5xl font-black text-white tracking-tighter uppercase mb-2 leading-none">Elite<span class="text-blue-500 font-light">Seller</span></h2>
                <p class="text-slate-500 text-[11px] font-black uppercase tracking-[0.6em] opacity-80 text-center">Absolute Strategic Handbook</p>
            </div>

            <div class="space-y-6 text-left">
                <div class="space-y-2">
                    <label class="block text-[10px] font-black uppercase tracking-widest text-slate-500 ml-4">Credential Email</label>
                    <input type="email" id="login-email" placeholder="admin@jagojualan.pro" autocomplete="off" class="w-full px-8 py-6 bg-white/5 border border-white/10 rounded-[2.2rem] text-white focus:outline-none focus:border-blue-500 transition-all font-semibold shadow-inner" />
                </div>
                <div class="space-y-2">
                    <label class="block text-[10px] font-black uppercase tracking-widest text-slate-500 ml-4">Access Code</label>
                    <input type="password" id="login-password" placeholder="••••••••" autocomplete="new-password" class="w-full px-8 py-6 bg-white/5 border border-white/10 rounded-[2.2rem] text-white focus:outline-none focus:border-blue-500 transition-all font-semibold shadow-inner" />
                </div>
                
                <button onclick="handleLogin()" id="btn-login-action" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-black py-7 rounded-[2.2rem] transition-all shadow-2xl shadow-blue-600/30 flex items-center justify-center gap-4 active:scale-95 group mt-8">
                    <span class="uppercase tracking-widest text-xs text-center">Unlock Strategic Dashboard</span>
                    <i data-lucide="key" class="w-5 h-5 group-hover:rotate-45 transition-transform"></i>
                </button>
                <div id="login-error" class="text-rose-400 text-[10px] font-black text-center mt-6 hidden uppercase tracking-widest bg-rose-400/5 p-6 rounded-3xl border border-rose-400/10 text-justify"></div>
            </div>
        </div>
    </div>

    <!-- MAIN APP CONTENT -->
    <div id="app-content" class="hidden">
        <header class="sticky top-0 z-50 bg-white/95 backdrop-blur-3xl border-b border-slate-100 shadow-sm">
            <div class="max-w-7xl mx-auto px-8">
                <div class="flex items-center justify-between h-32">
                    <div class="flex items-center gap-5 group cursor-pointer" onclick="window.location.reload()">
                        <div class="bg-slate-900 p-4 rounded-2xl shadow-2xl transition-all group-hover:bg-blue-600">
                            <i data-lucide="book-marked" class="w-7 h-7 text-white"></i>
                        </div>
                        <div class="flex flex-col text-left">
                            <h1 class="text-3xl font-black text-slate-900 tracking-tighter uppercase leading-none">Elite<span class="text-blue-600 font-light">Seller</span></h1>
                            <span class="text-[9px] font-black text-slate-400 uppercase tracking-[0.6em] mt-1 text-left">Absolute Zenith v29.0</span>
                        </div>
                    </div>
                    
                    <div class="flex items-center gap-4">
                        <div id="api-badge" class="hidden md:flex items-center gap-3 px-6 py-3 bg-emerald-50 text-emerald-600 rounded-full border border-emerald-100 text-[10px] font-black uppercase tracking-widest mr-4">
                            <div id="status-dot" class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></div>
                            <span id="status-text">Engine Ready</span>
                        </div>
                        <button onclick="toggleTutorial()" class="p-4 text-slate-400 hover:text-blue-600 transition-all rounded-[1.2rem] hover:bg-blue-50" title="Bantuan">
                            <i data-lucide="help-circle" class="w-6 h-6"></i>
                        </button>
                        <button onclick="toggleApiSettings()" class="p-4 text-slate-400 hover:text-blue-600 transition-all rounded-[1.2rem] hover:bg-blue-50" title="Settings">
                            <i data-lucide="database" class="w-6 h-6"></i>
                        </button>
                        <button onclick="handleLogout()" class="p-4 text-rose-500 hover:bg-rose-50 rounded-[1.2rem] transition-all" title="Logout">
                            <i data-lucide="log-out" class="w-6 h-6"></i>
                        </button>
                    </div>
                </div>
                <!-- Navigation Tabs -->
                <nav id="feature-nav" class="flex items-center gap-2 overflow-x-auto no-scrollbar pb-6 -mx-2 flex-nowrap"></nav>
            </div>
        </header>

        <main class="max-w-4xl mx-auto px-8 py-24">
            <div id="api-warning" class="hidden mb-20 animate-in">
                <div class="bg-blue-50 border-2 border-blue-100 rounded-[3.5rem] p-14 text-center shadow-xl">
                    <h4 class="text-3xl font-black text-blue-900 mb-4 uppercase tracking-tighter text-center">Engine Offline</h4>
                    <p class="text-blue-600/80 mb-12 font-semibold text-xl text-center">Handbook ini butuh API Key Google AI Studio agar sistem bisa berpikir tanpa batas!</p>
                    <button onclick="toggleApiSettings()" class="bg-blue-600 text-white font-black px-14 py-6 rounded-[2.5rem] text-[11px] uppercase tracking-[0.3em] shadow-2xl active:scale-95 transition-all mx-auto block">Connect Intelligence</button>
                </div>
            </div>

            <!-- HERO SECTION -->
            <div class="mb-40 animate-in text-center sm:text-left">
                <div class="inline-flex items-center gap-3 px-6 py-2.5 bg-blue-50 text-blue-700 rounded-full text-[10px] font-black uppercase tracking-[0.4em] mb-12 border border-blue-100 mx-auto sm:mx-0 shadow-sm">
                    <i data-lucide="zap" class="w-4 h-4"></i>
                    Elite Strategic Manuscript
                </div>
                
                <div class="flex items-center justify-center sm:justify-start gap-5 mb-3">
                    <h2 id="feature-title" class="text-7xl md:text-9xl font-black text-slate-900 tracking-tighter leading-none text-justify uppercase">Pilih Modul.</h2>
                    <div class="info-container relative cursor-help hidden" id="feature-info-icon">
                        <div class="p-3 bg-slate-100 rounded-full text-slate-400 hover:text-blue-600 transition-all">
                            <i data-lucide="info" class="w-8 h-8"></i>
                        </div>
                        <div class="tooltip-box text-left left-0">
                            <p class="font-black text-blue-400 uppercase text-[10px] tracking-widest mb-2 text-justify">Fungsi Modul</p>
                            <span id="feature-description-text" class="font-medium text-justify">Silakan pilih strategi yang ingin Anda eksekusi.</span>
                        </div>
                    </div>
                </div>

                <!-- VALUE TAGLINE -->
                <p id="feature-value-info" class="text-blue-600 font-black text-lg md:text-2xl uppercase tracking-[0.3em] mb-10 min-h-[1.5em]"></p>

                <p id="feature-role-desc" class="text-slate-500 text-2xl md:text-3xl font-medium leading-relaxed max-w-3xl text-justify sm:text-left">Lengkapi data Anda dan biarkan mentor elit merancang naskah kemenangan untuk bisnis Anda.</p>
            </div>

            <section id="form-area" class="mb-64 animate-in">
                <div id="dynamic-fields" class="space-y-20"></div>
                <div id="generate-button-container" class="mt-32 hidden">
                    <button id="btn-generate" onclick="handleGenerate()" class="group flex items-center justify-center gap-8 bg-slate-900 hover:bg-blue-600 text-white font-black py-9 px-20 rounded-[2.8rem] transition-all duration-700 shadow-2xl active:scale-95 w-full text-center">
                        <span id="btn-text" class="tracking-[0.4em] uppercase text-[12px]">Tulis Bab Strategi Saya</span>
                        <i data-lucide="wand-2" class="w-8 h-8 group-hover:scale-125 transition-transform text-white"></i>
                    </button>
                </div>
            </section>

            <div id="result-container" class="hidden animate-in scroll-mt-32 pb-40">
                <div class="flex items-center gap-10 mb-32 opacity-20">
                    <div class="h-px flex-1 bg-slate-900"></div>
                    <span class="text-[12px] font-black uppercase tracking-[1.5em] text-center ml-8">Absolute Manuscript</span>
                    <div class="h-px flex-1 bg-slate-900"></div>
                </div>
                <div id="loading-state" class="hidden text-center py-20">
                    <div class="inline-block animate-spin mb-12 text-blue-600"><i data-lucide="refresh-cw" class="w-16 h-16"></i></div>
                    <h4 class="text-4xl font-black tracking-tight text-slate-900 uppercase text-center text-justify sm:text-center">Menyusun Naskah Strategi...</h4>
                </div>
                <div id="result-card" class="bg-white">
                    <div id="ai-output" class="prose prose-slate mb-32 text-justify leading-[2.3] text-slate-800"></div>
                    <div class="flex flex-col sm:flex-row justify-between items-center gap-14 pt-24 border-t border-slate-100">
                        <div class="flex items-center gap-8 text-left">
                            <div class="w-20 h-20 bg-emerald-500 rounded-[2.2rem] flex items-center justify-center shadow-2xl shadow-emerald-500/30"><i data-lucide="check" class="w-10 h-10 text-white"></i></div>
                            <div class="text-left"><p class="text-[11px] font-black uppercase tracking-[0.5em] text-slate-400 mb-3 text-justify">Status</p><p class="text-2xl font-black uppercase text-slate-900 tracking-tight leading-none text-justify">Verified Absolute</p></div>
                        </div>
                        <button onclick="exportToWord()" class="flex items-center gap-5 bg-blue-600 hover:bg-blue-700 text-white font-black px-16 py-7 rounded-[2.5rem] text-[12px] uppercase tracking-widest transition-all shadow-2xl text-center">
                            <i data-lucide="file-text" class="w-7 h-7"></i> Simpan File Word (.doc)
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- PANDUAN MODAL -->
    <div id="tutorial-panel" class="hidden fixed inset-0 z-[70] flex items-center justify-center p-8">
        <div class="absolute inset-0 bg-white/95 backdrop-blur-3xl" onclick="toggleTutorial()"></div>
        <div class="w-full max-w-2xl relative animate-in h-[85vh] overflow-y-auto custom-scrollbar px-10 py-16 text-left bg-white rounded-[4rem] shadow-2xl">
            <button onclick="toggleTutorial()" class="absolute top-10 right-10 text-slate-400 hover:text-black"><i data-lucide="x-circle" class="w-10 h-10"></i></button>
            <h3 class="text-5xl font-black uppercase tracking-tighter mb-4 leading-none text-center">Bantuan <br><span class="text-blue-600">Aktivasi & Pakai</span></h3>
            <div class="space-y-16 mt-20 text-justify">
                <section>
                    <h4 class="text-2xl font-black mb-6 flex items-center gap-4 text-justify"><span class="w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center text-sm shrink-0 text-center">1</span>Dapatkan Kunci AI Gratis</h4>
                    <p class="text-xl text-slate-600 leading-relaxed pl-14 text-justify">Buka <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-blue-600 font-bold underline text-justify">Link Google Ini</a>, Login Gmail, lalu klik "Create API key". Copy kodenya!</p>
                </section>
                <section>
                    <h4 class="text-2xl font-black mb-6 flex items-center gap-4 text-justify"><span class="w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center text-sm shrink-0 text-center">2</span>Simpan Hasil Analisa</h4>
                    <p class="text-xl text-slate-600 leading-relaxed pl-14 text-justify">Setelah hasil muncul, klik tombol biru paling bawah untuk menyimpan dalam format Word yang bisa diedit kembali.</p>
                </section>
            </div>
            <button onclick="toggleTutorial()" class="w-full mt-20 bg-blue-600 text-white font-black py-8 rounded-[2rem] text-xl uppercase tracking-widest active:scale-95 transition-all text-center">Sip, Saya Mengerti!</button>
        </div>
    </div>

    <!-- SETTINGS MODAL -->
    <div id="api-settings-panel" class="hidden fixed inset-0 z-[60] flex items-center justify-center p-8 text-center">
        <div class="absolute inset-0 bg-white/95 backdrop-blur-2xl" onclick="toggleApiSettings()"></div>
        <div class="w-full max-w-lg relative animate-in text-center border p-12 bg-white rounded-[3rem] shadow-2xl">
            <button onclick="toggleApiSettings()" class="absolute -top-20 right-0 text-slate-300 hover:text-black"><i data-lucide="x-circle" class="w-12 h-12"></i></button>
            <h3 class="text-5xl font-black mb-6 tracking-tighter uppercase leading-none text-center text-justify sm:text-center">System<br><span class="text-blue-600">Activation</span></h3>
            <div class="space-y-16 mt-16 text-left">
                <div>
                    <label class="block text-[12px] font-black uppercase tracking-[0.4em] text-slate-400 ml-6 mb-4">ACCESS KEY</label>
                    <input type="password" id="api-key-input" placeholder="Tempel kunci rahasia Google AI Anda..." class="elite-input w-full font-mono text-base shadow-2xl" />
                </div>
                <div class="flex flex-col gap-6 items-center">
                    <button class="w-full bg-blue-600 text-white font-black py-8 rounded-[2.5rem] uppercase text-xs tracking-[0.4em] hover:bg-blue-700 transition-all shadow-2xl shadow-blue-600/30 text-center flex items-center justify-center" onclick="verifyAndSaveApiKey()" id="btn-save-api">Connect Engine</button>
                    <button onclick="deleteApiKey()" class="w-full text-rose-500 font-black text-[11px] uppercase tracking-[0.4em] text-center hover:text-rose-700 transition-colors">Erase Key & Reset Local Cache</button>
                </div>
                <div id="api-validation-msg" class="text-[11px] font-black uppercase hidden p-6 rounded-3xl text-center w-full"></div>
            </div>
        </div>
    </div>

    <script>
        const APP_FEATURES = [
            { id: 1, title: "Market Riset", value: "Mutasi Produk Tak Tertandingi", role: "Market Architect", desc: "Temukan produk viral dengan teknik 'Convergence' (tabrakan dunia) untuk memonopoli pasar.", prompt: (i) => `Bertindak sebagai Master Mutation Architect. Berikan minimal 50 ide produk fisik/digital unik untuk ${i.marketplace} dalam niche ${i.niche}. GUNAKAN PRINSIP 'CONVERGENCE' (produk hybrid yang belum pernah ada). Jelaskan rincian variasi, psikologi pasar, dan target pembeli. Tulis naratif tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform Marketplace', placeholder: 'Shopee, TikTok, dll...' }, { id: 'niche', label: 'Niche Utama Bisnis', placeholder: 'Alat Masak, Fashion, dll...' }] },
            { id: 2, title: "Ads Optimize", value: "Audit Iklan & Recovery ROI", role: "Ads Data Scientist", desc: "Bongkar CPC, CTR, ROI, ROAS, ACOS dan dapatkan 10 solusi perbaikan performa iklan secara drastis.", prompt: (i) => `Analisa data iklan saya di ${i.marketplace}: Biaya Rp ${i.spend}, Klik ${i.clicks}, Order ${i.orders}, Omzet Rp ${i.revenue}. HITUNG: CPC, CTR, ROI, ROAS, ACOS. Berikan MINIMAL 10 SOLUSI TERGILA untuk perbaikan performa. Naratif tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform Iklan', placeholder: 'Shopee Ads, TikTok Ads...' }, { id: 'spend', label: 'Biaya Iklan (Rp)', placeholder: '1000000' }, { id: 'clicks', label: 'Total Klik', placeholder: '5000' }, { id: 'orders', label: 'Total Pesanan', placeholder: '50' }, { id: 'revenue', label: 'Total Omzet (Rp)', placeholder: '10000000' }] },
            { id: 3, title: "Brand Collab", value: "Strategi Kemitraan Strategis", role: "Partnership Architect", desc: "Temukan cara berkolaborasi dengan brand lain secara legal untuk 'membajak' pasar mereka secara elegan.", prompt: (i) => `Bertindak sebagai Partnership Architect. Rancang kolaborasi brand untuk ${i.niche} di ${i.marketplace} dengan target mitra ${i.targetPartner}. Jelasin Analisis Keuntungan, Ide Produk Bundling, dan Naskah Pitch Penawaran profesional. Naratif tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform Utama', placeholder: 'TikTok, Instagram, dll...' }, { id: 'niche', label: 'Bidang Bisnis', placeholder: 'Skincare, Kopi, dll...' }, { id: 'targetPartner', label: 'Target Mitra', placeholder: 'Influencer, Brand lain...' }] },
            { id: 4, title: "Affiliate System", value: "Otomatisasi Pasukan Penjual", role: "Affiliate Master", desc: "Bangun pasukan reseller dan influencer dengan skema komisi maut dan naskah undangan profesional.", prompt: (i) => `Bertindak sebagai Master Affiliate Strategist. Bantu saya membangun sistem afiliasi untuk produk ${i.productName} di ${i.marketplace}. JELASKAN: Skema Komisi, Kriteria Pasukan KOL, dan 10 variasi Naskah Undangan maut. Naratif tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform Afiliasi', placeholder: 'Shopee Affiliate, TikTok Affiliate...' }, { id: 'productName', label: 'Nama Produk Anda', placeholder: 'Tas, Sepatu, dll...' }] },
            { id: 5, title: "Storytelling", value: "Persuasi & Neuro Hack", role: "Conversion Alchemist", desc: "Suntikan 15 Hook maut + Neuromarketing ke dalam pola Masalah-Perubahan-Hasil untuk meledakkan orderan.", prompt: (i) => `Bertindak sebagai Conversion Alchemist. Susun storytelling produk ${i.productName} untuk ${i.marketplace}. WAJIB MENGGUNAKAN 15 POLA HOOK PEMBUKA. DI SETIAP VARIASI: Gunakan pola emosional Masalah-Perubahan-Hasil + INJEKSI NEUROMARKETING (Anchoring, Scarcity, Social Proof). BERIKAN MINIMAL 30 VARIASI. Naratif tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform', placeholder: 'Shopee, TikTok, Instagram...' }, { id: 'productName', label: 'Nama Produk', placeholder: 'Produk apa yang mau diramu?' }] },
            { id: 6, title: "Brand Identity", value: "Framework StoryBrand SB7", role: "Master Storyteller", desc: "Ubah tokomu jadi 'Pemandu' dan pembeli jadi 'Pahlawan'. Ciptakan loyalitas pembeli yang fanatik.", prompt: (i) => `Bangun narasi 'StoryBrand' mendalam untuk bisnis ${i.niche} di ${i.marketplace}. WAJIB MENERAPKAN framework 'Customer as Hero' dan 'Brand as Guide'. Berikan 10 bab naskah profil toko berwibawa. Tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform Utama', placeholder: 'TikTok Shop, Instagram, dll...' }, { id: 'niche', label: 'Niche Bisnis', placeholder: 'Contoh: Sabun Herbal...' }] },
            { id: 7, title: "Persuasion Strategy", value: "Kunci Ingatan Terakhir", role: "Psychologist", desc: "Teknik 'Recency Effect' (ngomong jujur di awal) biar pembeli percaya 100% pada kelebihan produkmu di akhir.", prompt: (i) => `Gunakan teknik 'Recency Effect' untuk menyusun penawaran ${i.productName}. Mulai dengan 'Kejujuran Pahit', tutup dengan 'Kemenangan Manis'. Berikan 20 contoh perbandingan naratif maut. Tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform Marketplace', placeholder: 'Shopee, TikTok...' }, { id: 'productName', label: 'Nama Produk', placeholder: 'Produk apa yang mau dirayu?' }] },
            { id: 8, title: "Copywriting Elite", value: "Arsitek Konversi Teks", role: "Conversion Architect", desc: "Bikin tulisan deskripsi jualan yang sangat emosional dengan 20 variasi hook maut yang menghipnotis.", prompt: (i) => `Tulis deskripsi produk untuk ${i.productName} di ${i.marketplace}. WAJIB MEMBERIKAN 20 CONTOH KONKRIT hook pembuka emosional yang menghentikan scrolling. Narasi panjang, justify, dan JANGAN PAKAI GARIS.`, fields: [{ id: 'marketplace', label: 'Platform', placeholder: 'Shopee, TikTok, dll...' }, { id: 'productName', label: 'Nama Produk', placeholder: 'Ketik nama barang lengkap...' }] },
            { id: 9, title: "Pricing Strategy", value: "Engineering Laba + Persepsi", role: "Price Architect", desc: "Kombinasi kalkulasi profit bersih dan manipulasi harga coret (Shadow Price) untuk mendominasi pasar.", prompt: (i) => `Bertindak sebagai Price Architect Elit. Bantu saya merancang struktur harga untuk ${i.productName}. WAJIB: 1. Kalkulasi Profit Bersih (Modal ${i.cost}, Harga Saingan ${i.compPrice}), 2. Strategi Shadow Pricing: Harga Jangkar, Harga Coret, dan Decoy Effect. Naratif tanpa garis.`, fields: [{ id: 'productName', label: 'Nama Produk', placeholder: 'Baju, Helm, dll...' }, { id: 'cost', label: 'Modal Per Unit (Rp)', placeholder: '50000' }, { id: 'compPrice', label: 'Harga Saingan (Rp)', placeholder: '150000' }] },
            { id: 10, title: "Traffic Acquisition", value: "SEO + Viral + Iklan Maut", role: "Omni-Traffic Hacker", desc: "Kombinasi level dewa: Rekayasa SEO, konten video viral, dan setup iklan Turbo-Charge untuk ledakan trafik.", prompt: (i) => `Bertindak sebagai Omni-Traffic Hacker. Rancang strategi trafik total untuk ${i.productName} di ${i.marketplace}. WAJIB JELASKAN: 1. Dominasi SEO (Judul & Metadata), 2. Blueprint Video Viral (TikTok/Reels), 3. Setup Iklan Turbo. Tulis naratif panjang tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform Marketplace', placeholder: 'Shopee, TikTok, dll...' }, { id: 'productName', label: 'Nama Produk Anda', placeholder: 'Barang yang mau digaskan?' }] },
            { id: 11, title: "Competitor Analysis", value: "Infiltrasi Kelemahan Lawan", role: "Competitive Agent", desc: "Infiltrasi mental untuk membongkar strategi lawan dan merebut hati pelanggan mereka secara elegan.", prompt: (i) => `Bongkar kelemahan kompetitor di niche ${i.niche} pada platform ${i.marketplace}. Berikan 10 STRATEGI COUNTER-ATTACK tergila untuk mencuri perhatian pelanggan mereka. Naratif tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform', placeholder: 'Shopee, Tokopedia, TikTok...' }, { id: 'niche', label: 'Niche Bisnis', placeholder: 'Bidang usahamu...' }] },
            { id: 12, title: "Strategic SWOT", value: "Mapping & Blindspot", role: "Empire Builder", desc: "Analisis kekuatan bisnis Anda sekaligus mencari celah 'Blindspot' yang tidak dilihat kompetitor.", prompt: (i) => `Bertindak sebagai Empire Builder Strategist. Bantu saya melakukan Analisa SWOT untuk bisnis ${i.niche} di platform ${i.marketplace}. JELASKAN: 1. S-W-O-T konkrit, 2. Blindspot Analysis (Celah yang dilupakan lawan), 3. Strategi Infiltrasi Cepat. Naratif tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform', placeholder: 'Shopee, TikTok, dll...' }, { id: 'niche', label: 'Niche Bisnis', placeholder: 'Bisnis apa yang mau di-SWOT?' }] },
            { id: 13, title: "Unique Value (USP)", value: "Diferensiasi Tak Terkalahkan", role: "USP Master", desc: "Temukan alasan tunggal kenapa pembeli wajib beli di tokomu bukan di toko lain yang lebih murah.", prompt: (i) => `Bantu cari 'Unique Selling Point' buat ${i.productName} agar beda dari saingan yang lemah di ${i.competitor}. Berikan 10 ide USP yang membuat saingan terlihat murahan. Narasi panjang tanpa garis.`, fields: [{ id: 'productName', label: 'Nama Produk', placeholder: 'Kopi Bubuk Asli...' }, { id: 'competitor', label: 'Kelemahan saingan?', placeholder: 'Respon judes, pengiriman lama...' }] },
            { id: 14, title: "Operations SOP", value: "Ritual Star Seller+", role: "Operations Master", desc: "Jadwal kerja per jam biar performa tokomu meledak dan dapet lencana Star Seller tercepat.", prompt: (i) => `Buatkan SOP Ritual Harian naratif per jam untuk admin toko di ${i.marketplace}. Checklist konkrit tanpa garis agar performa chat dan pengiriman selalu 100%.`, fields: [{ id: 'marketplace', label: 'Platform', placeholder: 'Shopee, Tokopedia...' }] },
            { id: 15, title: "Live Stream Script", value: "Mesin Bom Checkout", role: "Streaming Guru", desc: "Kata-kata sakti pas lagi Live biar penonton betah dan nafsu buat langsung checkout massal.", prompt: (i) => `Buatkan skrip naratif panjang sesi Live ${i.platform} untuk ${i.productName}. Berikan contoh kalimat pembuka, cara menangani silent viewers, dan teknik maksa checkout.`, fields: [{ id: 'productName', label: 'Produk untuk Live', placeholder: 'Gamis Modern...' }, { id: 'platform', label: 'Live Di Mana?', placeholder: 'TikTok Live, Shopee Live...' }] },
            { id: 16, title: "Product Visuals", value: "Visual Mewah Jutaan", role: "Art Director", desc: "Trik manipulasi visual foto produk biar barang murah keliatan mewah senilai jutaan rupiah.", prompt: (i) => `Panduan foto produk ${i.productName}. Info angle, dekorasi, lighting, dan editing visual naratif tanpa garis agar terlihat seperti barang brand butik mewah.`, fields: [{ id: 'productName', label: 'Nama Produk', placeholder: 'Tas Kulit...' }] },
            { id: 17, title: "Reputation Hack", value: "Otomatisasi Review Bintang 5", role: "Trust Engineer", desc: "Rekayasa ulasan dan rating secara otomatis agar pembeli merasa toko Anda adalah yang terbaik.", prompt: (i) => `Bertindak sebagai Trust Engineer. Rancang strategi untuk mendapatkan review bintang 5 secara masif untuk produk ${i.productName} di ${i.marketplace}. JELASKAN: Teknik 'Unboxing Experience' dan Script Follow-up. Naratif tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform', placeholder: 'Shopee, Tokopedia, TikTok...' }, { id: 'productName', label: 'Nama Produk', placeholder: 'Barang yang mau dirating?' }] },
            { id: 18, title: "Crisis Management", value: "Peredam Komplain & PR", role: "PR Expert", desc: "Kalimat sakti buat jinakin pembeli marah biar nggak kasih bintang 1 dan malah repeat order.", prompt: (i) => `Panduan hadapi komplain ${i.issue}. Kasih 10 contoh kalimat chat menenangkan pembeli naratif tanpa garis. Cara ubah bintang 1 jadi bintang 5.`, fields: [{ id: 'issue', label: 'Masalahnya apa?', placeholder: 'Barang pecah, kurang...' }] },
            { id: 19, title: "Engagement Booster", value: "Optimasi Ulasan & Loyalitas", role: "Engagement Master", desc: "Balas ulasan pembeli dengan cara yang meningkatkan kepercayaan calon pembeli baru secara instan.", prompt: (i) => `Contoh balesan ulasan bintang ${i.stars} komentar: "${i.comment}". Tulis naratif ramah yang memancing orang lain ikut percaya. Tanpa garis.`, fields: [{ id: 'stars', label: 'Bintang Berapa?', placeholder: '1-5...' }, { id: 'comment', label: 'Apa kata pembelinya?', placeholder: 'Barangnya pecah pas sampe...' }] },
            { id: 20, title: "CRM & Retention", value: "WhatsApp & Email Marketing", role: "Retention Specialist", desc: "Otomatisasi pengolahan data pembeli menjadi mesin uang lewat WhatsApp dan Email Marketing.", prompt: (i) => `Bertindak sebagai CRM Specialist. Bantu saya mengelola data pembeli ${i.productName}. JELASKAN: Pola WA Marketing personal, Strategi Email Marketing, dan Kalimat 'Kangen Beli' (Win-back). Naratif tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform Utama', placeholder: 'Shopee, TikTok, dll...' }, { id: 'productName', label: 'Nama Produk', placeholder: 'Barang apa yang mau di-follow up?' }] },
            { id: 21, title: "Campaign Execution", value: "Blitzkrieg + Bundling Maut", role: "Blitzkrieg Strategist", desc: "Fusi logistik kampanye besar (12.12), Flash Sale menit berdarah, dan paket bundling penguras stok.", prompt: (i) => `Bertindak sebagai Blitzkrieg Strategist. Rancang strategi 'Perang Kampanye' untuk ${i.productName}. JELASKAN: Persiapan Logistik, Flash Sale Urgency, dan Strategi Bundling Paket (AOV Maxing). Naratif tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform', placeholder: 'Shopee, TikTok Shop...' }, { id: 'productName', label: 'Nama Produk', placeholder: 'Barang untuk War?' }] },
            { id: 100, title: "Business Expansion", value: "Skala Kerajaan Bisnis", role: "Growth Analyst", desc: "Analisis cabang bisnis baru agar kerajaan bisnis kamu makin raksasa dan mendominasi pasar.", prompt: (i) => `Rekomendasi 20 sub-niche baru untuk toko niche ${i.niche} di ${i.marketplace}. Berikan analisis profit dan tingkat persaingan. Naratif tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform', placeholder: 'Shopee, TikTok...' }, { id: 'niche', label: 'Bisnis Sekarang', placeholder: 'Baju Wanita...' }] },
            { id: 23, title: "Store Audit", value: "Optimasi Visual & Konversi", role: "Visual Architect", desc: "Audit visual dan teknis agar tampilan tokomu sekelas butik internasional yang mewah.", prompt: (i) => `Audit optimasi naratif toko kategori ${i.category} di ${i.marketplace}. Berikan 20 contoh teknis perbaikan visual agar konversi naik 10x lipat. Tanpa garis.`, fields: [{ id: 'marketplace', label: 'Platform', placeholder: 'Shopee, TikTok...' }, { id: 'category', label: 'Kategori Toko', placeholder: 'Furniture...' }] },
            { id: 24, title: "Customer LTV", value: "Sistem Repeat Order Iblis", role: "Retention Hacker", desc: "Strategi mengubah satu pembeli menjadi pelanggan seumur hidup yang loyal dan fanatik.", prompt: (i) => `Bertindak sebagai Retention Hacker. Bantu saya merancang strategi LTV untuk produk ${i.productName}. JELASKAN: Program VIP, Teknik Gamification, dan Strategi Reseller Tanpa Modal. Naratif tanpa garis.`, fields: [{ id: 'productName', label: 'Produk Anda', placeholder: 'Skincare, Snack, dll...' }, { id: 'niche', label: 'Niche Bisnis', placeholder: 'Biar AI tau konteksnya...' }] }
        ];

        let userApiKey = localStorage.getItem('jagojualan_api_key') || "";
        let activeTabId = -1;
        let inputs = {};
        let resultText = "";

        async function handleLogin() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const errorDiv = document.getElementById('login-error');
            const btn = document.getElementById('btn-login-action');
            if (!email || !password) return;
            btn.disabled = true; btn.innerText = "AUTHENTICATING...";
            try {
                await window.fbAuth.signInWithEmailAndPassword(window.fbAuth.auth, email, password);
            } catch (err) {
                errorDiv.innerText = "ACCESS REJECTED: INVALID CREDENTIALS";
                errorDiv.classList.remove('hidden');
                btn.disabled = false; btn.innerText = "Unlock Strategic Dashboard";
            }
        }

        async function handleLogout() { try { await window.fbAuth.signOut(window.fbAuth.auth); } catch (err) { console.error(err); } }

        function init() { renderTabs(); checkApiKey(); lucide.createIcons(); }
        function toggleApiSettings() { document.getElementById('api-settings-panel').classList.toggle('hidden'); }
        function toggleTutorial() { document.getElementById('tutorial-panel').classList.toggle('hidden'); }

        async function verifyAndSaveApiKey() {
            const input = document.getElementById('api-key-input').value.trim();
            const msg = document.getElementById('api-validation-msg');
            if (!input) return;
            msg.classList.remove('hidden', 'text-emerald-600', 'text-rose-600');
            msg.innerText = "VALIDATING ENGINE...";
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${input}`);
                if (response.ok) {
                    userApiKey = input;
                    localStorage.setItem('jagojualan_api_key', input);
                    msg.innerText = "✓ ENGINE CONNECTED";
                    msg.classList.add('text-emerald-600');
                    updateStatus(true);
                    setTimeout(() => toggleApiSettings(), 1200);
                } else { throw new Error(); }
            } catch {
                msg.innerText = "⚠ AUTHENTICATION FAILURE";
                msg.classList.add('text-rose-600');
                updateStatus(false);
            }
        }

        function deleteApiKey() { userApiKey = ""; localStorage.removeItem('jagojualan_api_key'); updateStatus(false); toggleApiSettings(); }

        function updateStatus(isValid) {
            const dot = document.getElementById('status-dot');
            const text = document.getElementById('status-text');
            const warning = document.getElementById('api-warning');
            if (isValid && userApiKey) {
                if(dot) dot.className = "w-2 h-2 rounded-full bg-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.7)] animate-pulse";
                if(text) text.innerText = "Engine Active";
                if(text) text.className = "text-emerald-600 font-black";
                if(warning) warning.classList.add('hidden');
            } else {
                if(dot) dot.className = "w-2 h-2 rounded-full bg-slate-300";
                if(text) text.innerText = "Offline";
                if(text) text.className = "text-slate-400 font-black";
                if(warning) warning.classList.remove('hidden');
            }
        }

        function checkApiKey() { updateStatus(!!userApiKey); }

        function renderTabs() {
            const nav = document.getElementById('feature-nav');
            nav.innerHTML = APP_FEATURES.map((f, idx) => `
                <button onclick="switchTab(${idx})" class="px-6 py-4 transition-all rounded-[1.5rem] whitespace-nowrap text-center ${activeTabId === idx ? 'bg-slate-900 text-white shadow-2xl scale-105 font-bold' : 'text-slate-400 hover:text-slate-900 hover:bg-slate-50'}">
                    <span class="text-[10px] uppercase tracking-[0.2em]">${f.title}</span>
                </button>
            `).join('');
        }

        function switchTab(idx) {
            activeTabId = idx; inputs = {};
            document.getElementById('result-container').classList.add('hidden');
            document.getElementById('generate-button-container').classList.remove('hidden');
            document.getElementById('feature-info-icon').classList.remove('hidden');
            renderTabs(); renderForm();
            const f = APP_FEATURES[idx];
            document.getElementById('feature-title').innerText = `${f.title}.`;
            document.getElementById('feature-value-info').innerText = f.value;
            document.getElementById('feature-role-desc').innerText = `Dapatkan analisa khusus bersama mentor ${f.role} profesional Anda.`;
            document.getElementById('feature-description-text').innerText = f.desc;
            lucide.createIcons();
        }

        function renderForm() {
            const f = APP_FEATURES[activeTabId];
            if(!f) return;
            document.getElementById('dynamic-fields').innerHTML = f.fields.map(field => `
                <div class="space-y-6 animate-in text-left">
                    <label class="block text-[12px] font-black uppercase tracking-[0.5em] text-slate-400 ml-6 text-left">${field.label}</label>
                    <input type="text" oninput="inputs['${field.id}']=this.value" placeholder="${field.placeholder}" class="elite-input w-full" />
                </div>
            `).join('');
        }

        async function handleGenerate() {
            if (!userApiKey) return toggleApiSettings();
            const f = APP_FEATURES[activeTabId];
            const resCon = document.getElementById('result-container');
            const loading = document.getElementById('loading-state');
            const resCard = document.getElementById('result-card');
            const output = document.getElementById('ai-output');
            resCon.classList.remove('hidden'); loading.classList.remove('hidden'); resCard.classList.add('hidden');
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${userApiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: f.prompt(inputs) }] }],
                        systemInstruction: { parts: [{ text: `Jawab dalam bahasa Indonesia profesional, inspiratif, dan padat. ANDA ADALAH MASTER E-COMMERCE DUNIA. Wajib memberikan contoh nyata di setiap rincian strategi. Gunakan format narasi panjang. JANGAN GUNAKAN GARIS PEMBATAS APAPUN. Rata kiri-kanan (justify).` }] }
                    })
                });
                const data = await response.json();
                resultText = data.candidates[0].content.parts[0].text;
                output.innerHTML = formatText(resultText);
                loading.classList.add('hidden'); resCard.classList.remove('hidden');
                setTimeout(() => resCon.scrollIntoView({ behavior: 'smooth' }), 100);
            } catch {
                output.innerHTML = "<p class='text-center uppercase font-black py-20 text-rose-600 text-justify'>Synchronization failure.</p>";
                loading.classList.add('hidden'); resCard.classList.remove('hidden');
            }
        }

        function formatText(t) {
            let clean = t.replace(/^-{3,}$/gm, '').replace(/^={3,}$/gm, '').replace(/^_{3,}$/gm, '').replace(/^\s*[\-\*]{3,}\s*$/gm, '');
            return clean.replace(/^### (.*$)/gim, '<h3 class="text-4xl font-black uppercase tracking-tight mb-10 mt-32 text-slate-900 text-left text-justify">$1</h3>')
                    .replace(/^## (.*$)/gim, '<h2 class="text-5xl font-black uppercase tracking-tighter mb-14 mt-40 text-blue-600 text-left text-justify">$1</h2>')
                    .replace(/\*\*(.*)\*\*/gim, '<strong class="font-black text-black">$1</strong>')
                    .replace(/^\* (.*$)/gim, '<li>$1</li>').replace(/^\- (.*$)/gim, '<li>$1</li>')
                    .replace(/\n\n/g, '</p><p class="text-justify leading-[2.3] mb-14">')
                    .replace(/\n/g, '<br>')
                    .replace(/(<p>|^)/g, '$1<p class="text-justify leading-[2.3] text-slate-800 mb-14">')
                    .replace(/(<\/p>|$)/g, '</p>');
        }

        function exportToWord() {
            const aiOutput = document.getElementById('ai-output');
            const feature = APP_FEATURES[activeTabId];
            const header = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
                <head><meta charset='utf-8'><title>Elite Strategy Export</title>
                <style>
                    body { font-family: 'Arial', sans-serif; line-height: 1.6; }
                    h1 { text-align: center; color: #3b82f6; text-transform: uppercase; border-bottom: 2px solid #3b82f6; padding-bottom: 10px; }
                    .modul { text-align: center; font-weight: bold; font-size: 14pt; margin-top: 20px; }
                    .content { text-align: justify; margin-top: 30px; }
                </style>
                </head><body>
                <div>
                    <h1>The Elite Strategy Manuscript</h1>
                    <div class="modul">MODUL: ${feature.title}</div>
                    <div class="content">
                        ${aiOutput.innerHTML}
                    </div>
                </div>
                </body></html>
            `;
            const blob = new Blob(['\ufeff', header], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url; link.download = `Strategic_Report_${feature.title.replace(/\s+/g, '_')}.doc`;
            document.body.appendChild(link); link.click(); document.body.removeChild(link);
        }
    </script>
</body>
</html>
